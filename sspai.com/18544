➜派早报：Apple 将于 10 月 14 日举行发布会、一加官方公布 OnePlus 8T 外观等
https://sspai.com/post/63049	3041
<h2>Apple 将于 10 月 14 日举行发布会</h2><p>10 月 7 日，Apple 正式宣布将于北京时间 10 月 14 日凌晨 1:00 举行主题为「Hi, Speed.」的线上发布会，届时发布会将在官网、爱奇艺、哔哩哔哩、腾讯视频、微博和优酷进行直播。</p><figure class="image ss-img-wrapper image_resized" style="width:357px;"><img src="https://cdn.sspai.com/2020/10/08/article/18582436287f05ecb9166a30c1f924ef"></figure><p>据爆料，iPhone 12 系列将于发布会上正式发布，并于 10 月 16 日接受预订、10 月 23 日正式发售；其中，iPhone 12 Pro / Pro Max 起步容量提升至 128GB。此外，头戴式耳机 AirPods Studio、Apple TV、外接游戏手柄等产品也可能于发布会上进行发布。<a href="https://mp.weixin.qq.com/s/QhoHQNfaMkKNXBD0oKRTAg">来源</a></p><h2>一加官方公布 OnePlus 8T 外观</h2><p>10 月 8 日晚，一加 CEO 刘作虎在微博发布 OnePlus 8T 预热视频。视频展露了 OnePlus 8T 主打的「青域」配色机身，以及 AG 玻璃材质，四摄圆角矩形模组位于背部左上角。机身背盖还融入了「漫反射纹理」，可以呈现出「釉面质感」而不易沾指纹。<a href="https://cn.engadget.com/oneplus-8t-design-teaser-151634469.html">来源</a></p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/10/09/article/6d617c7b005b485894c1d48eb1fc5621"></figure><h2>微信推出「青少年模式」</h2><p>10 月 2 日，微信更新 iOS 版本推出「青少年模式」。开启和关闭青少年模式需要输入微信密码验证，用户可以设置微信在开启青少年模式之后多项功能的使用访问，包括视频号、公众号、小程序、摇一摇、看一看、搜一搜、附近的人、游戏功能的访问范围；此外，微信还增加了表情包功能，朋友圈支持标签功能等。微信团队表示，Android 版本微信的「青少年模式」也将于近期上线。<a href="https://weibo.com/1930378853/JnkFsvuNd">来源</a></p><figure class="image ss-img-wrapper image_resized" style="width:350px;"><img src="https://cdn.sspai.com//2020/10/08/05a4e41b87de4be441dea0759f376530.jpeg"></figure><h2>AMD 推出基于 ZEN 3 架构的 5000 系列处理器</h2><p>AMD 首席执行官 Dr. Lisa Su 通过线上发布了 AMD ZEN 3 架构，以及搭载本代架构的产品 AMD 锐龙 5000 系列处理器。ZEN 3 架构基于 7nm 制作工艺打造，提升了 Boost 加速频率，IPC 提升 19%。此外，ZEN 3 使用了全新的核心布局，运行占用缓存较大的软件或游戏时表现更好。</p><p>AMD 锐龙 5000 系列处理器将于 11 月 5 日全球开卖，旗舰级桌面处理器 AMD Ryzen 9 5950X 的售价为 799 美金。<a href="http://diy.zol.com.cn/753/7537017_all.html">来源</a></p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/10/09/article/7824403bdad6360395b1a5ce9f02530c"></figure><h2>Apple 和 Epic Games 诉讼案将于 2021 年 5 月开庭</h2><p>据 AppleInsider 报道，Apple 与 Epic Games 的诉讼案件将于美国当地时间 2021 年 5 月 3 日开庭审理，诉讼将由法官而非陪审团进行主导审判。</p><p>此前，Epic Games 因不满 App Store 过高的分成比例在旗下游戏《堡垒之夜》的 iOS 版本中提供了绕过 iTunes 的付费方式，游戏随后被 Apple 下架，Epic Games 因此联合 Spotify、Basecamp 等公司组成「应用公平联盟」(The Coalition for App Fairness)，旨在对于 App Store 对于开发者的不公平行为进行抗争。<a href="https://appleinsider.com/articles/20/10/07/apple-vs-epic-fortnite-trial-is-starting-on-may-3-2021">来源</a></p><h2>G Suite 更名为 Google Workspace</h2><p>10 月 6 日，Google 正式宣布推出 Google Workspace 生产力套件。在此前 G Suite 的基础之上，Google Workspace 将进一步对 Google 旗下的生产力工具进行整合，同时以 Gmail 为首的多项服务也借本次机会更新产品标识，视觉风格上更加统一；Google Workspace 将在接下来数月内陆续完成更新和推送，面向教育市场和非盈利组织的 G Suite 用户也将在后续收到更新。<a href="https://cloud.google.com/blog/products/workspace/introducing-google-workspace">来源</a></p><figure class="image ss-img-wrapper image_resized" style="width:449px;"><img src="https://cdn.sspai.com/2020/10/09/article/1bf9e513d6ba8d1e7af1b02d849eabe7"></figure><h2>Bing 更名为 Microsoft Bing</h2><p>10 月 5 日，微软正式宣布旗下搜索引擎 Bing 更名为 Microsoft Bing，微软表示本次更名是为了体现 Bing 在整个微软生态中的持续整合。除此之外，搜索返利项目 Give with Bing 也正式登陆除美国之外的 7 个国家和地区，包括英国、加拿大、澳大利亚等。<a href="https://blogs.bing.com/search/2020_10/Microsoft-Bing-the-search-engine-that-gives-back">来源</a></p><h2>你可能错过的文章</h2><ul><li><a href="https://sspai.com/post/63016" target="_blank">装修笔记 01 | 家的样子，你的样子</a></li><li><a href="https://sspai.com/post/63026" target="_blank">从有趣转向实用，这 16 款日常 iOS 应用也支持了小组件</a></li><li><a href="https://sspai.com/post/63039" target="_blank">巧用 Figma，你也可以轻松制作表情包</a></li><li><a href="https://sspai.com/post/63019" target="_blank">微软 2020 年秋季新品汇总：小升级、新变化</a></li><li><a href="https://sspai.com/post/63005" target="_blank">三条产品线、四款新产品：Google 秋季硬件新品发布会回顾</a></li></ul><p style="margin-left:0px;">&gt; 下载少数派 <a href="https://sspai.com/page/client">客户端</a>、关注 <a href="https://sspai.com/s/J71e">少数派公众号</a>，了解科技圈每日新鲜事 📰</p><p style="margin-left:0px;">&gt; 实用、好用的&nbsp;<a href="https://sspai.com/mall/class/28" target="_blank">正版软件</a>，少数派为你呈现&nbsp;🚀</p><p>© 本文着作权归作者所有，并授权少数派独家使用，未经少数派许可，不得转载使用。</p>
➜开源、可定制的网页批注工具——Hypothesis
https://sspai.com/post/63033	13539
<h3 style="margin-left:0px;"><strong>Matrix 首页推荐</strong></h3><p style="margin-left:0px;"><a href="https://sspai.com/matrix">Matrix</a> 是少数派的写作社区，我们主张分享真实的产品体验，有实用价值的经验与思考。我们会不定期挑选 Matrix 最优质的文章，展示来自用户的最真实的体验和观点。</p><p style="margin-left:0px;">文章代表作者个人观点，少数派仅对标题和排版略作修改。</p><hr><h2>引言</h2><p>俗话说「不动笔墨不读书」，但在网络阅读的场景下，给「笔墨」找到合适的电子替代物并不容易。尽管市面上存在不少批注网页文章的解决方案，但仔细想来，似乎很少有哪个工具能较好地同时满足以下几个要求：</p><ul><li><strong>跨平台：</strong>电子阅读的场景非常宽泛，理想的工具应当在各个平台上都能使用。</li><li><strong>可溯源：</strong>批注内容往往需要和原始上下文结合才便于理解。因此，理想的工具不仅应该记录批注的内容，还应该能追溯到批注在原始文本中的位置。</li><li><strong>可迁移：</strong>批注的主要意义在于事后参考引用。为此，理想的工具应当允许将数据以通用格式导出，最好还能提供 API 以便对接其他工具和实现自动化。</li></ul><p>究其原因，上述目标在网页环境下中并不容易达成，甚至是相互矛盾的：不同平台的功能和交互逻辑各异，很难开发出通用的解决方案；网页文本很不稳定，其内容和格式经常随着编辑、改版而变化。因此，为实现跨平台和可溯源，大多数产品都选择了牺牲可迁移性，以私有格式存储批注数据，并且批注的对象往往并非原始网页，而是其经过优化和重排版后的「替身」。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/16dc5a110a2806afac468c2d6aecef98.png"><figcaption>Instapaper 等主流工具一般是在创建的网页「替身」上实现批注</figcaption></figure><p>不过，今年早些时候，我偶然发现了一个名为 <a href="ttps://hypothes.is/">Hypothesis</a> 的工具。这是一个<a href="https://github.com/hypothesis/h">开源项目</a>，注册和使用完全免费，收入主要通过为教育行业<a href="https://web.hypothes.is/help/how-much-does-it-cost-to-use-hypothesis/">定制 LMS（学习管理系统）</a>支撑。</p><p>与 Pocket、Instapaper 等知名服务相比，Hypothesis 给我的最初印象是其貌不扬、界面简陋，且上手门槛较高。但在熟悉操作后，我发现它正是一个能较好兼顾上述三个理想特性的工具。</p><p>概括而言，Hypothesis 实现这些特性的方式是：</p><ul><li><strong>跨平台：</strong>Hypothesis 没有客户端，其功能主要通过小书签（bookmarklet）访问。打开任何网页后点击该书签，就可以加载 Hypothesis 的代码、启用批注，回避了针对各个平台安装专用客户端的麻烦。此外，它还提供了一个代理入口 <a href="https://via.hypothes.is/"><code>https://via.hypothes.is/</code></a>，通过该入口访问网页后可以直接开始批注。</li><li><strong>可溯源：</strong>Hypothesis 在批注时不仅会记录批注内容，而且会通过多种方式记录批注在原文中的位置（下文将会详细解释），这使得即便网页内容发生较大变化，它仍然能准确定位。</li><li><strong>可迁移：</strong>Hypothesis 提供了完善的 API，可以结构化地导出所有批注数据。此外，Hypothesis API 还有一个半官方的网页前端 <a href="https://jonudell.info/h/facet/">Facet</a>，可以搜索满足特定条件的批注，并导出为 HTML、CSV 等格式。</li></ul><p>下文将首先演示 Hypothsis 的基础操作，然后在实验基础上解释该服务实现原理中的独特之处，最后介绍基于 Hypothsis API 的一些进阶用法。</p><h2>一、简易上手</h2><p>我们以批注<a href="https://type.cyhsu.xyz/2020/08/hyperlink-best-practices/">随机挑选的一个网页</a>为例（好吧，并没有随机，是我写的文章，原谅这点私心），演示 Hypothesis 的基本用法。</p><h3>（一）注册和配置</h3><p>首先，前往 Hypothesis 官网，<a href="https://hypothes.is/signup">注册一个账号</a>。</p><p>完成注册并登录后，点击页面右上角的齿轮图标，选择「<a href="https://hypothes.is/account/developer">Developer</a>」，生成自己账号对应的 <strong>API token</strong>，留存备用。</p><p>然后，到<a href="https://web.hypothes.is/start/">指引页面</a>找到「Hypothesis Bookmarklet」小书签按钮，将其拖拽到浏览器的书签栏，或者点击右键添加到书签。Chrome 用户也可以选择安装插件，但其功能与小书签并无差异，没有太大必要。</p><h3>（二）批注</h3><p>打开要批注的网页，点击上面步骤添加的小书签。稍等片刻，Hypothesis 的工具条就会出现在页面右侧。点击其顶部的箭头按钮将面板展开，然后点击「Log in」登录自己的账号。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/016d70b3bed6e28ef4c266054218278e.png"><figcaption>Hypothesis 的批注工具栏</figcaption></figure><p>注意到面板顶部的「Public」字样，这代表批注内容将被存放在一个公开的分组（group）中，其他 Hypothesis 用户在批注相同网页时将可以看到你的用户名和批注。如果对此介意，可以点击并切换到「Private」分组。你也可以根据自己的整理需要，创建任意名称的分组。</p><p>这时，选中网页上任意文本，页面就会弹出一个工具列，允许你选择将这段文本高亮（highlight）或添加批注（annotate）；<strong>批注功能支持 Markdown 语法、LaTeX 公式和添加标签（tag）</strong>。</p><p>批注过程中，Hypothesis 工具条会以数字标签的形式实时展示已有批注的数量和位置，点击即可快速定位和编辑。你也可以点击工具条上的眼形按钮隐藏高亮，或者点击便签按钮添加针对整个页面的批注。</p><h3>（三）回顾、审阅和导出</h3><p>Hypothesis 主界面会显示近期批注过的网页；点击标题将其展开，即可看到各条批注，并进行跳转到原文、编辑、链接分享等操作。你也可以通过页面顶部的搜索框根据内容、分组、URL、标签等条件搜索批注。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/48b9b78956fea06dd2339e36958eba27.png"><figcaption>Hypothesis 管理界面</figcaption></figure><p>可惜的是，Hypothesis 官网的检索功能比较简陋，也没有提供批量导出功能。对此，最简单的解决方案是使用前面提到的 <a href="https://jonudell.info/h/facet/">Facet</a> 工具。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/595e8bd0cef3d3cbd8c7700ca5cac566.png"><figcaption>Facet 界面</figcaption></figure><p>访问该工具页面后，在左上角的「User」框中填入自己的 Hypothesis 用户名，并在左下角的「Hypothesis API token」框中填入之前生成的 API token，然后根据需要填写其他检索条件（留空则默认显示近期批注页面），就可以在页面右侧看到实时更新的检索结果。如果需要批量导出，可以点击「CSV」或「JSON」按钮获得相应格式的数据，然后用 Excel 等工具进一步处理即可。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/6cf7ed13e3e6ab49d4c2f0f8a0982db9.png"><figcaption>Facet 导出的 CSV 格式批注数据</figcaption></figure><h2>二、Hypothesis 的杀手锏——「模煳锚定」</h2><p>如果只看上面的操作步骤和界面，你也许会和我最开始一样，觉得 Hypothesis 只是一个比较简陋的批注工具。但 Hypothesis 的真正实力在于底层——即使网页被编辑得「面目全非」，它仍然可以准确定位到原始的批注位置。</p><p>我们可以通过一个实验来演示 Hypothesis 对于页面变动情况的适应能力。</p><p>下图中的页面是我用 Notion 创建的。Notion 的页面由可以随意移动和变换的块（block）组成，可以很方便地模拟网页文本内容和结构的变动。这个最初版本的页面包含一个可折叠列表，其中有三个子列表项。我用 Hypothsis 高亮了其中的第一项。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/7f6c99df22222bc58bae6fbc94a49d9a.png"></figure><p>现在，交换其中第一项和第二项的顺序，刷新页面后重新打开 Hypothesis。可以看到，它正确地识别出了列表项位置的变化，维持了原来的第一项（现在的第二项）的高亮。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/2719793446089e95650b80003d577504.png"></figure><p>接着，尝试更大幅度地改变页面布局，例如 (a) 将原有的高亮项移到可折叠列表之外（相当于改变了元素的层级），或者 (b) 删除原有高亮项、并另起一行填入相同的文本（相当于删除原有元素、然后创建一个类似的新元素）。可以看到，Hypothesis 仍然找出了最接近的元素，并将其关联到既有的标注上。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/3b43515cb039185ab1efc976447a779f.png"></figure><p>事实上，即使将原来被高亮的第一项完全删除，并打乱列表的顺序，Hypothesis 仍然会尽力寻找最接近的高亮项。根据下图，它的匹配结果是原来的第三项，因为它在层级、位置等方面最接近于被删除的第一项。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/3d42657452c655548f7fdf259e6ae81b.png"></figure><p>而当将整个列表完全删除时，Hypothesis 也就选择了适可而止，不再尝试高亮页面元素，而是将丢失关联的高亮项显示在「orphaned」分类下，让用户仍然可以看到之前摘录的内容。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/141d81bbbc6869728673d9d3ad004467.png"></figure><p>那么，Hypothesis 的这种溯源能力是如何实现的呢？为此，首先要理解通过程序定位网页文本难在何处。</p><p>人脑和电脑对网页文本的认识是不一样的。在我们眼中，网页上的文本就是由一个个字码成的，是一个扁平的、串状的结构。而在电脑看来，网页是一棵由不同层级的元素组成的「树」（<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document_Object_Model/Introduction">DOM 模型</a>），而网页上的文本就是这棵树上的枝节。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/7599a12a6007f2136270ffb3f2bf33cb.png"><figcaption>通过浏览器的「检查元素」功能即可看出用户和电脑对网页文本的不同认识：线性（上）和树状（下）</figcaption></figure><p>假如网站发生改版，但既有的文章内容不变，那么在用户眼中，文章还是原来的文章，扫视一下就能找到原来某个句子的新位置。即使少量修订了正文内容，凭借文义、上下文等信息来重新定位也不是难事。</p><p>但对于电脑来说，即使版式、内容只发生轻微的变动，代表着先前版本的那棵「树」就已经面目全非了——枝节的数量、层级和排列方式都发生了改变。因此，很难只靠元素路径、文本内容等单一维度的信息找回原有文本的新位置。</p><p><strong>Hypothesis 是通过一套称为「模煳锚定」（</strong><a href="https://web.hypothes.is/blog/fuzzy-anchoring/"><strong>Fuzzy Anchoring</strong></a><strong>）的方法来解决这个问题的。</strong></p><p>这种方案有点像综合了人脑和电脑的认知方式，既将标注文本看作 DOM 树状结构上的元素，记录其层级路径；又将其看作连贯文本中的一段，记录其所在位置和上下文。在重新加载页面时，也结合使用这些记录信息，通过精度要求逐渐降低的多次尝试，定位到原始的标注文本。</p><p>具体而言，在存储标注文本在页面上的位置时，Hypothesis 会同时使用三种不同方法：</p><ol><li>用<strong>「范围选择器」</strong>（<code>RangeSelector</code>）记录标注文本在网页树状结构中的位置，即文本开始和结尾对应的 <a href="https://developer.mozilla.org/en-US/docs/Web/XPath">XPath</a> 路径及偏移量。用通俗的话说，类似于「高亮部分开始于第一根大树枝上的第二根小树枝左起 3 厘米处，结束于第二根大树枝上的第三根小树枝左起 2 厘米处」。</li><li>将网页上的元素逐个转换为文本（技术上是通过 <a href="https://developer.mozilla.org/en-US/docs/DOM/Selection">DOM Selection API</a> 中的 <code>.toString</code> 方法）并串联起来，然后通过<strong>「文本位置选择器」</strong>（<code>TextPositionSelector</code>）记录标注文本的开头和结尾在这一整段文本中的位置。这类似于用户对网页文本的线性理解方式：「高亮部分从第 7610 个字开始，到第 8124 个字为止」。</li><li>通过<strong>「文本引用选择器」</strong>（<code>TextQuoteSelector</code>）记录标注文本的原始内容以及其前后各 32 个字符的上下文——类似于「高亮的这句话是『我在百货公司当售货员』，它的上一句是『张华考上了北京大学』，下一句是『我们都有光明的前途』」。</li></ol><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/a2b039d9ac04c95138fcf51e25ab98ab.png"><figcaption>Hypothesis 使用的选择器</figcaption></figure><p>而当用户重新打开一个之前标注过的网页时，Hypothesis 便会依次利用上面记录的几种信息，试图定位标注文本：</p><ol><li>尝试用 <code>RangeSelector</code> 记录的路径和偏移量，在 DOM 中直接定位文本，然后将定位结果和文本引用选择器中记录的文本内容比对，如一致，则认为匹配成功。显然，如果网页的内容和结构都没有发生变化，这将是最快捷准确的方式。</li><li>如果前一种方法未成功，说明网页的结构可能已经发生变化。这时，Hypothesis 会重新将网页转换为文本，然后根据 <code>TextPositionSelector</code> 记录的范围进行定位，并将结果和之前记录的内容比对，如一致，则认为匹配成功。</li><li>如果仍然未能准确定位，说明网页的结构和内容都发生了变化。这时，Hypothesis 会选择放弃准确定位，以 <code>TextQuoteSelector</code> 中记录的上下文为关键词作全文模煳搜索；如果能找到类似的上下文，并且其中「夹」着的内容和之前记录的标注内容大致相同，就认为这是原来的标注文本。</li><li>如果这种「前后夹击」还是查无结果，Hypothesis 会进行最后一次尝试，直接用 <code>TextQuoteSelector</code> 记录的原始标注内容在网页全文中作模煳搜索，并将大致相同的搜索结果看成是原来的标注文本。</li><li>如果上述努力全部归于失败，Hypothesis 就会将这段「无家可归」的标注显示在侧边栏的<a href="https://web.hypothes.is/blog/showing-orphaned-annotations/">「孤本」</a>（orphaned）分类下，以供用户参考。</li></ol><p>在这样一套缜密机制的支撑下，Hypothesis 较强的定位回溯能力也就不难理解了。</p><h2>三、API 的进阶使用——以将最近批注导出为 Markdown 为例</h2><p>尽管 Hypothesis 网站和 Facet 已经能实现多数常用功能，但还是不足以满足更个性化的需求。我自己的习惯就是标注完一个网页后以 Markdown 格式导出，其内容包括带链接的标题和列表形式的摘录内容：</p><pre class="language-markdown"><code>### [标题](http://examples.com)
- 第一条高亮内容
- 第二条高亮内容
…</code></pre><p>为此，我制作了一个相应的 <a href="https://get.cyhsu.xyz/DOu9QjbB" target="_blank">Alfred 动作</a>：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/69b40f4164df967aa2c398b5b5856987.gif"></figure><p>（<strong>注：</strong>导入时，需要填写自己的用户名和 API token。该动作基于 Python 3，并且依赖 requests 和 pyperclip 用于发送请求和写入系统剪贴板：<code>python3 -m pip install requests pyperclip</code>。）</p><p>对于 iOS 上的使用场景，我也制作了一个<a href="https://www.icloud.com/shortcuts/83f06d40e12c4076ad4e6433abf77261">捷径动作</a>实现类似效果：</p><figure class="image ss-img-wrapper image_resized" style="width:336px;"><img src="https://cdn.sspai.com//2020/10/05/d71557943caca5939bfa238bd4c6f0d9.gif"></figure><p>（<strong>注：</strong>限于捷径 app 的功能，该动作无法像 Alfred 版本那样实现按批注在原文中的位置排列的功能，而只能根据创建批注的顺序排列。）</p><p>上面的效果都是通过调用 Hypothesis API 实现的。</p><p>Hypothesis API 的功能非常完善，覆盖了批注从添加、搜索到编辑的整个周期，具体可以查阅 <a href="https://h.readthedocs.io/en/latest/api-reference/v1/#section/Hypothesis-API">API 文档</a>来了解。其中，与获取和导出批注内容最相关的是<strong>搜索 API</strong>，使用要点是：</p><ul><li>地址：<code>https://api.hypothes.is/api/search</code></li><li>方法：<code>GET</code></li><li>鉴权：Bearer 方式，即应在请求 header 中加入 <code>Authorization: Bearer &lt;API token&gt;</code></li><li>参数：用户名（<code>user</code>）、网址（<code>uri</code>）、结果条数（<code>limit</code>，上限为 200）等</li></ul><p>搜索 API 的响应为 JSON 格式，其中：</p><ul><li><code>rows</code> 数组中的每个对象对应一条批注记录，默认按照更新时间倒序排列（可以通过 <code>sort</code> 参数改为创建时间或网址排列等）。</li><li>每个批注对象中的 <code>target</code> 数组都包含 3 个对象，依次对应上文介绍过的「范围选择器」（<code>RangeSelector</code>）、「文本位置选择器」（<code>TextPositionSelector</code>）和「文本引用选择器」（<code>TextQuoteSelector</code>）。</li></ul><p>因此，就获取高亮文本内容而言，应当获取文本引用选择器对象下的 <code>exact</code>（原文）键值。换言之，对于序号为 n（从 0 起算）的批注，其原文内容在输出中的位置（JSONPath）是：</p><pre class="language-json"><code>$['rows'][n]['target'][0]['selector'][2]['exact']</code></pre><p>在此基础上，我们就可以通过程序方式获取符合指定条件的批注文本，并整理为任意所需的格式。</p><h2>总结与建议</h2><p>除了上面提到的功能特性，Hypothesis 还有不少隐藏用法。例如，除了标注网页，Hypothesis 还可以用来<a href="https://web.hypothes.is/help/annotating-locally-saved-pdfs/">批注 PDF 文档</a>，无论 PDF 是存在线上还是本地。另外，通过 Hypothesis 创建的公开批注可以通过 RSS 地址 <code>https://hypothes.is/stream.rss?user=&lt;username&gt;</code> 订阅，从而实现与 IFTTT 等自动化工具的整合等。</p><p>当然，Hypothesis 仍然有很多不足。例如，Hypothesis 通过 JavaScript 书签启用批注的方式，虽然具有较好的跨平台能力，但有时会影响页面的布局，或和网页原有的交互功能冲突。在 Safari 这类隐私管理较为严格的浏览器上，其 Cookies 信息会时常被清除，导致需要频繁重新登录，显得比较麻烦。</p><p>又如，Hypothesis 并不像很多其他服务那样提供网页备份功能，从而将其拿手的「模煳锚定」功能置于一种尴尬境地：如果连网页本身都被删除，再强的批注定位能力也无用武之处。因此，对于具有较高保存价值的网页，先用 <a href="https://archive.org/web/">Wayback Machine</a> 等工具创建快照副本，再用 Hypothesis 对副本做批注，会是更稳妥的做法。</p><p>更重要的是，Hypothesis 归根结底是一个面向教育和学术应用场景开发的项目，网页版服务只是将相关技术简单包装后提供给公众的公益「副业」。外观简陋、上手门槛较高等特点不仅是情理之中，而且在今后很可能也会一直如此，不太可能像某些资金充裕的明星服务那样快速迭代、花样频出。</p><p>因此，如果你在找的是一个美观方便、上手即用的阅读、批注工具，Hypothesis 可能并不适合你，付费购买 Pocket、Instapaper 等商业化服务的会籍是省心的选择。但如果你对于批注工具的可定制性有较高的要求，或者准备将网页批注整合进自己的知识管理流程，并且不排斥通过一定的 DIY 实现想要的效果，Hypothesis 肯定是一个值得尝试的选择。</p><p>&gt; 下载少数派&nbsp;<a href="https://sspai.com/page/client">客户端&nbsp;</a>、关注&nbsp;<a href="https://sspai.com/s/J71e">少数派公众号&nbsp;</a>，了解更妙的数字生活 🍃<br>&gt; 想申请成为少数派作者？<a href="https://sspai.com/apply/writing">冲！</a></p>