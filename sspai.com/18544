➜派早报：Apple 将于 10 月 14 日举行发布会、一加官方公布 OnePlus 8T 外观等
https://sspai.com/post/63049	3041
<h2>Apple 将于 10 月 14 日举行发布会</h2><p>10 月 7 日，Apple 正式宣布将于北京时间 10 月 14 日凌晨 1:00 举行主题为「Hi, Speed.」的线上发布会，届时发布会将在官网、爱奇艺、哔哩哔哩、腾讯视频、微博和优酷进行直播。</p><figure class="image ss-img-wrapper image_resized" style="width:357px;"><img src="https://cdn.sspai.com/2020/10/08/article/18582436287f05ecb9166a30c1f924ef"></figure><p>据爆料，iPhone 12 系列将于发布会上正式发布，并于 10 月 16 日接受预订、10 月 23 日正式发售；其中，iPhone 12 Pro / Pro Max 起步容量提升至 128GB。此外，头戴式耳机 AirPods Studio、Apple TV、外接游戏手柄等产品也可能于发布会上进行发布。<a href="https://mp.weixin.qq.com/s/QhoHQNfaMkKNXBD0oKRTAg">来源</a></p><h2>一加官方公布 OnePlus 8T 外观</h2><p>10 月 8 日晚，一加 CEO 刘作虎在微博发布 OnePlus 8T 预热视频。视频展露了 OnePlus 8T 主打的「青域」配色机身，以及 AG 玻璃材质，四摄圆角矩形模组位于背部左上角。机身背盖还融入了「漫反射纹理」，可以呈现出「釉面质感」而不易沾指纹。<a href="https://cn.engadget.com/oneplus-8t-design-teaser-151634469.html">来源</a></p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/10/09/article/6d617c7b005b485894c1d48eb1fc5621"></figure><h2>微信推出「青少年模式」</h2><p>10 月 2 日，微信更新 iOS 版本推出「青少年模式」。开启和关闭青少年模式需要输入微信密码验证，用户可以设置微信在开启青少年模式之后多项功能的使用访问，包括视频号、公众号、小程序、摇一摇、看一看、搜一搜、附近的人、游戏功能的访问范围；此外，微信还增加了表情包功能，朋友圈支持标签功能等。微信团队表示，Android 版本微信的「青少年模式」也将于近期上线。<a href="https://weibo.com/1930378853/JnkFsvuNd">来源</a></p><figure class="image ss-img-wrapper image_resized" style="width:350px;"><img src="https://cdn.sspai.com//2020/10/08/05a4e41b87de4be441dea0759f376530.jpeg"></figure><h2>AMD 推出基于 ZEN 3 架构的 5000 系列处理器</h2><p>AMD 首席执行官 Dr. Lisa Su 通过线上发布了 AMD ZEN 3 架构，以及搭载本代架构的产品 AMD 锐龙 5000 系列处理器。ZEN 3 架构基于 7nm 制作工艺打造，提升了 Boost 加速频率，IPC 提升 19%。此外，ZEN 3 使用了全新的核心布局，运行占用缓存较大的软件或游戏时表现更好。</p><p>AMD 锐龙 5000 系列处理器将于 11 月 5 日全球开卖，旗舰级桌面处理器 AMD Ryzen 9 5950X 的售价为 799 美金。<a href="http://diy.zol.com.cn/753/7537017_all.html">来源</a></p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/10/09/article/7824403bdad6360395b1a5ce9f02530c"></figure><h2>Apple 和 Epic Games 诉讼案将于 2021 年 5 月开庭</h2><p>据 AppleInsider 报道，Apple 与 Epic Games 的诉讼案件将于美国当地时间 2021 年 5 月 3 日开庭审理，诉讼将由法官而非陪审团进行主导审判。</p><p>此前，Epic Games 因不满 App Store 过高的分成比例在旗下游戏《堡垒之夜》的 iOS 版本中提供了绕过 iTunes 的付费方式，游戏随后被 Apple 下架，Epic Games 因此联合 Spotify、Basecamp 等公司组成「应用公平联盟」(The Coalition for App Fairness)，旨在对于 App Store 对于开发者的不公平行为进行抗争。<a href="https://appleinsider.com/articles/20/10/07/apple-vs-epic-fortnite-trial-is-starting-on-may-3-2021">来源</a></p><h2>G Suite 更名为 Google Workspace</h2><p>10 月 6 日，Google 正式宣布推出 Google Workspace 生产力套件。在此前 G Suite 的基础之上，Google Workspace 将进一步对 Google 旗下的生产力工具进行整合，同时以 Gmail 为首的多项服务也借本次机会更新产品标识，视觉风格上更加统一；Google Workspace 将在接下来数月内陆续完成更新和推送，面向教育市场和非盈利组织的 G Suite 用户也将在后续收到更新。<a href="https://cloud.google.com/blog/products/workspace/introducing-google-workspace">来源</a></p><figure class="image ss-img-wrapper image_resized" style="width:449px;"><img src="https://cdn.sspai.com/2020/10/09/article/1bf9e513d6ba8d1e7af1b02d849eabe7"></figure><h2>Bing 更名为 Microsoft Bing</h2><p>10 月 5 日，微软正式宣布旗下搜索引擎 Bing 更名为 Microsoft Bing，微软表示本次更名是为了体现 Bing 在整个微软生态中的持续整合。除此之外，搜索返利项目 Give with Bing 也正式登陆除美国之外的 7 个国家和地区，包括英国、加拿大、澳大利亚等。<a href="https://blogs.bing.com/search/2020_10/Microsoft-Bing-the-search-engine-that-gives-back">来源</a></p><h2>你可能错过的文章</h2><ul><li><a href="https://sspai.com/post/63016" target="_blank">装修笔记 01 | 家的样子，你的样子</a></li><li><a href="https://sspai.com/post/63026" target="_blank">从有趣转向实用，这 16 款日常 iOS 应用也支持了小组件</a></li><li><a href="https://sspai.com/post/63039" target="_blank">巧用 Figma，你也可以轻松制作表情包</a></li><li><a href="https://sspai.com/post/63019" target="_blank">微软 2020 年秋季新品汇总：小升级、新变化</a></li><li><a href="https://sspai.com/post/63005" target="_blank">三条产品线、四款新产品：Google 秋季硬件新品发布会回顾</a></li></ul><p style="margin-left:0px;">&gt; 下载少数派 <a href="https://sspai.com/page/client">客户端</a>、关注 <a href="https://sspai.com/s/J71e">少数派公众号</a>，了解科技圈每日新鲜事 📰</p><p style="margin-left:0px;">&gt; 实用、好用的&nbsp;<a href="https://sspai.com/mall/class/28" target="_blank">正版软件</a>，少数派为你呈现&nbsp;🚀</p><p>© 本文着作权归作者所有，并授权少数派独家使用，未经少数派许可，不得转载使用。</p>
➜开源、可定制的网页批注工具——Hypothesis
https://sspai.com/post/63033	13539
<h3 style="margin-left:0px;"><strong>Matrix 首页推荐</strong></h3><p style="margin-left:0px;"><a href="https://sspai.com/matrix">Matrix</a> 是少数派的写作社区，我们主张分享真实的产品体验，有实用价值的经验与思考。我们会不定期挑选 Matrix 最优质的文章，展示来自用户的最真实的体验和观点。</p><p style="margin-left:0px;">文章代表作者个人观点，少数派仅对标题和排版略作修改。</p><hr><h2>引言</h2><p>俗话说「不动笔墨不读书」，但在网络阅读的场景下，给「笔墨」找到合适的电子替代物并不容易。尽管市面上存在不少批注网页文章的解决方案，但仔细想来，似乎很少有哪个工具能较好地同时满足以下几个要求：</p><ul><li><strong>跨平台：</strong>电子阅读的场景非常宽泛，理想的工具应当在各个平台上都能使用。</li><li><strong>可溯源：</strong>批注内容往往需要和原始上下文结合才便于理解。因此，理想的工具不仅应该记录批注的内容，还应该能追溯到批注在原始文本中的位置。</li><li><strong>可迁移：</strong>批注的主要意义在于事后参考引用。为此，理想的工具应当允许将数据以通用格式导出，最好还能提供 API 以便对接其他工具和实现自动化。</li></ul><p>究其原因，上述目标在网页环境下中并不容易达成，甚至是相互矛盾的：不同平台的功能和交互逻辑各异，很难开发出通用的解决方案；网页文本很不稳定，其内容和格式经常随着编辑、改版而变化。因此，为实现跨平台和可溯源，大多数产品都选择了牺牲可迁移性，以私有格式存储批注数据，并且批注的对象往往并非原始网页，而是其经过优化和重排版后的「替身」。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/16dc5a110a2806afac468c2d6aecef98.png"><figcaption>Instapaper 等主流工具一般是在创建的网页「替身」上实现批注</figcaption></figure><p>不过，今年早些时候，我偶然发现了一个名为 <a href="ttps://hypothes.is/">Hypothesis</a> 的工具。这是一个<a href="https://github.com/hypothesis/h">开源项目</a>，注册和使用完全免费，收入主要通过为教育行业<a href="https://web.hypothes.is/help/how-much-does-it-cost-to-use-hypothesis/">定制 LMS（学习管理系统）</a>支撑。</p><p>与 Pocket、Instapaper 等知名服务相比，Hypothesis 给我的最初印象是其貌不扬、界面简陋，且上手门槛较高。但在熟悉操作后，我发现它正是一个能较好兼顾上述三个理想特性的工具。</p><p>概括而言，Hypothesis 实现这些特性的方式是：</p><ul><li><strong>跨平台：</strong>Hypothesis 没有客户端，其功能主要通过小书签（bookmarklet）访问。打开任何网页后点击该书签，就可以加载 Hypothesis 的代码、启用批注，回避了针对各个平台安装专用客户端的麻烦。此外，它还提供了一个代理入口 <a href="https://via.hypothes.is/"><code>https://via.hypothes.is/</code></a>，通过该入口访问网页后可以直接开始批注。</li><li><strong>可溯源：</strong>Hypothesis 在批注时不仅会记录批注内容，而且会通过多种方式记录批注在原文中的位置（下文将会详细解释），这使得即便网页内容发生较大变化，它仍然能准确定位。</li><li><strong>可迁移：</strong>Hypothesis 提供了完善的 API，可以结构化地导出所有批注数据。此外，Hypothesis API 还有一个半官方的网页前端 <a href="https://jonudell.info/h/facet/">Facet</a>，可以搜索满足特定条件的批注，并导出为 HTML、CSV 等格式。</li></ul><p>下文将首先演示 Hypothsis 的基础操作，然后在实验基础上解释该服务实现原理中的独特之处，最后介绍基于 Hypothsis API 的一些进阶用法。</p><h2>一、简易上手</h2><p>我们以批注<a href="https://type.cyhsu.xyz/2020/08/hyperlink-best-practices/">随机挑选的一个网页</a>为例（好吧，并没有随机，是我写的文章，原谅这点私心），演示 Hypothesis 的基本用法。</p><h3>（一）注册和配置</h3><p>首先，前往 Hypothesis 官网，<a href="https://hypothes.is/signup">注册一个账号</a>。</p><p>完成注册并登录后，点击页面右上角的齿轮图标，选择「<a href="https://hypothes.is/account/developer">Developer</a>」，生成自己账号对应的 <strong>API token</strong>，留存备用。</p><p>然后，到<a href="https://web.hypothes.is/start/">指引页面</a>找到「Hypothesis Bookmarklet」小书签按钮，将其拖拽到浏览器的书签栏，或者点击右键添加到书签。Chrome 用户也可以选择安装插件，但其功能与小书签并无差异，没有太大必要。</p><h3>（二）批注</h3><p>打开要批注的网页，点击上面步骤添加的小书签。稍等片刻，Hypothesis 的工具条就会出现在页面右侧。点击其顶部的箭头按钮将面板展开，然后点击「Log in」登录自己的账号。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/016d70b3bed6e28ef4c266054218278e.png"><figcaption>Hypothesis 的批注工具栏</figcaption></figure><p>注意到面板顶部的「Public」字样，这代表批注内容将被存放在一个公开的分组（group）中，其他 Hypothesis 用户在批注相同网页时将可以看到你的用户名和批注。如果对此介意，可以点击并切换到「Private」分组。你也可以根据自己的整理需要，创建任意名称的分组。</p><p>这时，选中网页上任意文本，页面就会弹出一个工具列，允许你选择将这段文本高亮（highlight）或添加批注（annotate）；<strong>批注功能支持 Markdown 语法、LaTeX 公式和添加标签（tag）</strong>。</p><p>批注过程中，Hypothesis 工具条会以数字标签的形式实时展示已有批注的数量和位置，点击即可快速定位和编辑。你也可以点击工具条上的眼形按钮隐藏高亮，或者点击便签按钮添加针对整个页面的批注。</p><h3>（三）回顾、审阅和导出</h3><p>Hypothesis 主界面会显示近期批注过的网页；点击标题将其展开，即可看到各条批注，并进行跳转到原文、编辑、链接分享等操作。你也可以通过页面顶部的搜索框根据内容、分组、URL、标签等条件搜索批注。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/48b9b78956fea06dd2339e36958eba27.png"><figcaption>Hypothesis 管理界面</figcaption></figure><p>可惜的是，Hypothesis 官网的检索功能比较简陋，也没有提供批量导出功能。对此，最简单的解决方案是使用前面提到的 <a href="https://jonudell.info/h/facet/">Facet</a> 工具。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/595e8bd0cef3d3cbd8c7700ca5cac566.png"><figcaption>Facet 界面</figcaption></figure><p>访问该工具页面后，在左上角的「User」框中填入自己的 Hypothesis 用户名，并在左下角的「Hypothesis API token」框中填入之前生成的 API token，然后根据需要填写其他检索条件（留空则默认显示近期批注页面），就可以在页面右侧看到实时更新的检索结果。如果需要批量导出，可以点击「CSV」或「JSON」按钮获得相应格式的数据，然后用 Excel 等工具进一步处理即可。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/6cf7ed13e3e6ab49d4c2f0f8a0982db9.png"><figcaption>Facet 导出的 CSV 格式批注数据</figcaption></figure><h2>二、Hypothesis 的杀手锏——「模煳锚定」</h2><p>如果只看上面的操作步骤和界面，你也许会和我最开始一样，觉得 Hypothesis 只是一个比较简陋的批注工具。但 Hypothesis 的真正实力在于底层——即使网页被编辑得「面目全非」，它仍然可以准确定位到原始的批注位置。</p><p>我们可以通过一个实验来演示 Hypothesis 对于页面变动情况的适应能力。</p><p>下图中的页面是我用 Notion 创建的。Notion 的页面由可以随意移动和变换的块（block）组成，可以很方便地模拟网页文本内容和结构的变动。这个最初版本的页面包含一个可折叠列表，其中有三个子列表项。我用 Hypothsis 高亮了其中的第一项。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/7f6c99df22222bc58bae6fbc94a49d9a.png"></figure><p>现在，交换其中第一项和第二项的顺序，刷新页面后重新打开 Hypothesis。可以看到，它正确地识别出了列表项位置的变化，维持了原来的第一项（现在的第二项）的高亮。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/2719793446089e95650b80003d577504.png"></figure><p>接着，尝试更大幅度地改变页面布局，例如 (a) 将原有的高亮项移到可折叠列表之外（相当于改变了元素的层级），或者 (b) 删除原有高亮项、并另起一行填入相同的文本（相当于删除原有元素、然后创建一个类似的新元素）。可以看到，Hypothesis 仍然找出了最接近的元素，并将其关联到既有的标注上。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/3b43515cb039185ab1efc976447a779f.png"></figure><p>事实上，即使将原来被高亮的第一项完全删除，并打乱列表的顺序，Hypothesis 仍然会尽力寻找最接近的高亮项。根据下图，它的匹配结果是原来的第三项，因为它在层级、位置等方面最接近于被删除的第一项。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/3d42657452c655548f7fdf259e6ae81b.png"></figure><p>而当将整个列表完全删除时，Hypothesis 也就选择了适可而止，不再尝试高亮页面元素，而是将丢失关联的高亮项显示在「orphaned」分类下，让用户仍然可以看到之前摘录的内容。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/141d81bbbc6869728673d9d3ad004467.png"></figure><p>那么，Hypothesis 的这种溯源能力是如何实现的呢？为此，首先要理解通过程序定位网页文本难在何处。</p><p>人脑和电脑对网页文本的认识是不一样的。在我们眼中，网页上的文本就是由一个个字码成的，是一个扁平的、串状的结构。而在电脑看来，网页是一棵由不同层级的元素组成的「树」（<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document_Object_Model/Introduction">DOM 模型</a>），而网页上的文本就是这棵树上的枝节。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/7599a12a6007f2136270ffb3f2bf33cb.png"><figcaption>通过浏览器的「检查元素」功能即可看出用户和电脑对网页文本的不同认识：线性（上）和树状（下）</figcaption></figure><p>假如网站发生改版，但既有的文章内容不变，那么在用户眼中，文章还是原来的文章，扫视一下就能找到原来某个句子的新位置。即使少量修订了正文内容，凭借文义、上下文等信息来重新定位也不是难事。</p><p>但对于电脑来说，即使版式、内容只发生轻微的变动，代表着先前版本的那棵「树」就已经面目全非了——枝节的数量、层级和排列方式都发生了改变。因此，很难只靠元素路径、文本内容等单一维度的信息找回原有文本的新位置。</p><p><strong>Hypothesis 是通过一套称为「模煳锚定」（</strong><a href="https://web.hypothes.is/blog/fuzzy-anchoring/"><strong>Fuzzy Anchoring</strong></a><strong>）的方法来解决这个问题的。</strong></p><p>这种方案有点像综合了人脑和电脑的认知方式，既将标注文本看作 DOM 树状结构上的元素，记录其层级路径；又将其看作连贯文本中的一段，记录其所在位置和上下文。在重新加载页面时，也结合使用这些记录信息，通过精度要求逐渐降低的多次尝试，定位到原始的标注文本。</p><p>具体而言，在存储标注文本在页面上的位置时，Hypothesis 会同时使用三种不同方法：</p><ol><li>用<strong>「范围选择器」</strong>（<code>RangeSelector</code>）记录标注文本在网页树状结构中的位置，即文本开始和结尾对应的 <a href="https://developer.mozilla.org/en-US/docs/Web/XPath">XPath</a> 路径及偏移量。用通俗的话说，类似于「高亮部分开始于第一根大树枝上的第二根小树枝左起 3 厘米处，结束于第二根大树枝上的第三根小树枝左起 2 厘米处」。</li><li>将网页上的元素逐个转换为文本（技术上是通过 <a href="https://developer.mozilla.org/en-US/docs/DOM/Selection">DOM Selection API</a> 中的 <code>.toString</code> 方法）并串联起来，然后通过<strong>「文本位置选择器」</strong>（<code>TextPositionSelector</code>）记录标注文本的开头和结尾在这一整段文本中的位置。这类似于用户对网页文本的线性理解方式：「高亮部分从第 7610 个字开始，到第 8124 个字为止」。</li><li>通过<strong>「文本引用选择器」</strong>（<code>TextQuoteSelector</code>）记录标注文本的原始内容以及其前后各 32 个字符的上下文——类似于「高亮的这句话是『我在百货公司当售货员』，它的上一句是『张华考上了北京大学』，下一句是『我们都有光明的前途』」。</li></ol><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/a2b039d9ac04c95138fcf51e25ab98ab.png"><figcaption>Hypothesis 使用的选择器</figcaption></figure><p>而当用户重新打开一个之前标注过的网页时，Hypothesis 便会依次利用上面记录的几种信息，试图定位标注文本：</p><ol><li>尝试用 <code>RangeSelector</code> 记录的路径和偏移量，在 DOM 中直接定位文本，然后将定位结果和文本引用选择器中记录的文本内容比对，如一致，则认为匹配成功。显然，如果网页的内容和结构都没有发生变化，这将是最快捷准确的方式。</li><li>如果前一种方法未成功，说明网页的结构可能已经发生变化。这时，Hypothesis 会重新将网页转换为文本，然后根据 <code>TextPositionSelector</code> 记录的范围进行定位，并将结果和之前记录的内容比对，如一致，则认为匹配成功。</li><li>如果仍然未能准确定位，说明网页的结构和内容都发生了变化。这时，Hypothesis 会选择放弃准确定位，以 <code>TextQuoteSelector</code> 中记录的上下文为关键词作全文模煳搜索；如果能找到类似的上下文，并且其中「夹」着的内容和之前记录的标注内容大致相同，就认为这是原来的标注文本。</li><li>如果这种「前后夹击」还是查无结果，Hypothesis 会进行最后一次尝试，直接用 <code>TextQuoteSelector</code> 记录的原始标注内容在网页全文中作模煳搜索，并将大致相同的搜索结果看成是原来的标注文本。</li><li>如果上述努力全部归于失败，Hypothesis 就会将这段「无家可归」的标注显示在侧边栏的<a href="https://web.hypothes.is/blog/showing-orphaned-annotations/">「孤本」</a>（orphaned）分类下，以供用户参考。</li></ol><p>在这样一套缜密机制的支撑下，Hypothesis 较强的定位回溯能力也就不难理解了。</p><h2>三、API 的进阶使用——以将最近批注导出为 Markdown 为例</h2><p>尽管 Hypothesis 网站和 Facet 已经能实现多数常用功能，但还是不足以满足更个性化的需求。我自己的习惯就是标注完一个网页后以 Markdown 格式导出，其内容包括带链接的标题和列表形式的摘录内容：</p><pre class="language-markdown"><code>### [标题](http://examples.com)
- 第一条高亮内容
- 第二条高亮内容
…</code></pre><p>为此，我制作了一个相应的 <a href="https://get.cyhsu.xyz/DOu9QjbB" target="_blank">Alfred 动作</a>：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/05/69b40f4164df967aa2c398b5b5856987.gif"></figure><p>（<strong>注：</strong>导入时，需要填写自己的用户名和 API token。该动作基于 Python 3，并且依赖 requests 和 pyperclip 用于发送请求和写入系统剪贴板：<code>python3 -m pip install requests pyperclip</code>。）</p><p>对于 iOS 上的使用场景，我也制作了一个<a href="https://www.icloud.com/shortcuts/83f06d40e12c4076ad4e6433abf77261">捷径动作</a>实现类似效果：</p><figure class="image ss-img-wrapper image_resized" style="width:336px;"><img src="https://cdn.sspai.com//2020/10/05/d71557943caca5939bfa238bd4c6f0d9.gif"></figure><p>（<strong>注：</strong>限于捷径 app 的功能，该动作无法像 Alfred 版本那样实现按批注在原文中的位置排列的功能，而只能根据创建批注的顺序排列。）</p><p>上面的效果都是通过调用 Hypothesis API 实现的。</p><p>Hypothesis API 的功能非常完善，覆盖了批注从添加、搜索到编辑的整个周期，具体可以查阅 <a href="https://h.readthedocs.io/en/latest/api-reference/v1/#section/Hypothesis-API">API 文档</a>来了解。其中，与获取和导出批注内容最相关的是<strong>搜索 API</strong>，使用要点是：</p><ul><li>地址：<code>https://api.hypothes.is/api/search</code></li><li>方法：<code>GET</code></li><li>鉴权：Bearer 方式，即应在请求 header 中加入 <code>Authorization: Bearer &lt;API token&gt;</code></li><li>参数：用户名（<code>user</code>）、网址（<code>uri</code>）、结果条数（<code>limit</code>，上限为 200）等</li></ul><p>搜索 API 的响应为 JSON 格式，其中：</p><ul><li><code>rows</code> 数组中的每个对象对应一条批注记录，默认按照更新时间倒序排列（可以通过 <code>sort</code> 参数改为创建时间或网址排列等）。</li><li>每个批注对象中的 <code>target</code> 数组都包含 3 个对象，依次对应上文介绍过的「范围选择器」（<code>RangeSelector</code>）、「文本位置选择器」（<code>TextPositionSelector</code>）和「文本引用选择器」（<code>TextQuoteSelector</code>）。</li></ul><p>因此，就获取高亮文本内容而言，应当获取文本引用选择器对象下的 <code>exact</code>（原文）键值。换言之，对于序号为 n（从 0 起算）的批注，其原文内容在输出中的位置（JSONPath）是：</p><pre class="language-json"><code>$['rows'][n]['target'][0]['selector'][2]['exact']</code></pre><p>在此基础上，我们就可以通过程序方式获取符合指定条件的批注文本，并整理为任意所需的格式。</p><h2>总结与建议</h2><p>除了上面提到的功能特性，Hypothesis 还有不少隐藏用法。例如，除了标注网页，Hypothesis 还可以用来<a href="https://web.hypothes.is/help/annotating-locally-saved-pdfs/">批注 PDF 文档</a>，无论 PDF 是存在线上还是本地。另外，通过 Hypothesis 创建的公开批注可以通过 RSS 地址 <code>https://hypothes.is/stream.rss?user=&lt;username&gt;</code> 订阅，从而实现与 IFTTT 等自动化工具的整合等。</p><p>当然，Hypothesis 仍然有很多不足。例如，Hypothesis 通过 JavaScript 书签启用批注的方式，虽然具有较好的跨平台能力，但有时会影响页面的布局，或和网页原有的交互功能冲突。在 Safari 这类隐私管理较为严格的浏览器上，其 Cookies 信息会时常被清除，导致需要频繁重新登录，显得比较麻烦。</p><p>又如，Hypothesis 并不像很多其他服务那样提供网页备份功能，从而将其拿手的「模煳锚定」功能置于一种尴尬境地：如果连网页本身都被删除，再强的批注定位能力也无用武之处。因此，对于具有较高保存价值的网页，先用 <a href="https://archive.org/web/">Wayback Machine</a> 等工具创建快照副本，再用 Hypothesis 对副本做批注，会是更稳妥的做法。</p><p>更重要的是，Hypothesis 归根结底是一个面向教育和学术应用场景开发的项目，网页版服务只是将相关技术简单包装后提供给公众的公益「副业」。外观简陋、上手门槛较高等特点不仅是情理之中，而且在今后很可能也会一直如此，不太可能像某些资金充裕的明星服务那样快速迭代、花样频出。</p><p>因此，如果你在找的是一个美观方便、上手即用的阅读、批注工具，Hypothesis 可能并不适合你，付费购买 Pocket、Instapaper 等商业化服务的会籍是省心的选择。但如果你对于批注工具的可定制性有较高的要求，或者准备将网页批注整合进自己的知识管理流程，并且不排斥通过一定的 DIY 实现想要的效果，Hypothesis 肯定是一个值得尝试的选择。</p><p>&gt; 下载少数派&nbsp;<a href="https://sspai.com/page/client">客户端&nbsp;</a>、关注&nbsp;<a href="https://sspai.com/s/J71e">少数派公众号&nbsp;</a>，了解更妙的数字生活 🍃<br>&gt; 想申请成为少数派作者？<a href="https://sspai.com/apply/writing">冲！</a></p>
➜苹果十月发布会前瞻：即将亮相的 iPhone 12，有哪些新变化？
https://sspai.com/post/63050	21805
<p>10 月 7 日凌晨，苹果正式宣布将于北京时间 10 月 14 日凌晨 1 点举办新品发布会，本次发布会的主角毫无疑问将是 iPhone 12，从目前爆出的消息来看，新款 iPhone 将迎来一次重大升级——新的外观设计、新的后置摄像头模组、支持 5G 网络、高刷新率屏幕等等。</p><p>除了 iPhone，苹果还有可能在这款发布会上发布几款配件产品，包括首个头戴式降噪耳机 AirPods Studio、追踪设备 AirTags 以及平价版的 HomePod。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/40c533009b6fd46b69cff537e8095d91.png"></figure><h2>iPhone 12：4 款新机，全新外观设计</h2><p>据 Twitter 用户 <a href="https://twitter.com/L0vetodream/status/1308009156486467584" target="_blank">@L0vetodream</a> 爆料，4 款新 iPhone 将分别被命名为 iPhone 12 mini、iPhone 12、iPhone 12 Pro 和 iPhone 12 Pro Max，售价依次提高，这也是苹果首次用 mini 来为 iPhone 命名。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/5506b6b3e58bea1e8813cb7b986c4209.png"></figure><p>之后 <a href="https://twitter.com/duanrui1205/status/1309328364872675330" target="_blank">@DuanRui</a> 也在 Twitter 上曝光了 3 张疑似为新款 iPhone 硅胶保护套的标签贴纸，可以看到贴纸上新款 iPhone 名称和 @L0vetodream 爆料一致。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/d198a9e2babf01a200b3867f3a5919be.png"><figcaption>图 / @DuanRui（Twitter）</figcaption></figure><h3>设计：iPhone 4 设计风格回归，新增深蓝配色</h3><p>4 款新 iPhone 都将采用类似 iPhone 4 的直角边框外形，其中 5.4 英寸机型大小和新款 iPhone SE 类似，6.1 英寸和 6.7 英寸机型大小与 iPhone 11 Pro、iPhone 11 Pro Max 大小类似。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/09/07/a2fb76300a53b0c4c7e926160165a0d1.jpg"><figcaption>图 / MacRumors</figcaption></figure><p>iPhone 12 mini 和 &nbsp;iPhone 12 可能会采用铝合金材质边框，而 2 款 iPhone 12 Pro 则将采用不锈钢材质边框。<a href="https://www.bloomberg.com/news/articles/2020-09-01/apple-targets-75-million-5g-iphones-for-fall-product-blitz" target="_blank">彭博社的报道</a> 中指出 iPhone 12 Pro 系列新增深蓝色取代 iPhone 11 Pro 的暗夜绿色，上个月发布的 Apple Watch Series 6 已经出现了新的深蓝配色，iPhone 12 Pro 的深蓝配色应该和 Apple Watch 类似。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/4a914c98f9fafbc1a496248045943f14.jpg"><figcaption>图 / Apple</figcaption></figure><p>而根据 <a href="http://www.chongdiantou.com/wp/archives/56970.html" target="_blank">充电头网</a> 近日的爆料，新款 iPhone 将采用磁吸充电设计，搭配同样采用磁吸设计的无线充电板，可以像 Apple Watch 一样在无线充电时自动吸附对准。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/09/07/9c46c562268feb75778c2aa4cdb89d64.jpeg"><figcaption>图 / 充电头网</figcaption></figure><p>硬件配置方面，iPhone 12 系列应该会采用和新款 iPad Air 一样的 A14 芯片，由于 iPad Air 目前尚未发售，所以暂时无法确认 A14 芯片的具体性能，但根据微博用户 <a href="https://weibo.com/3298489457/JnsaGF6WT" target="_blank">@我用第三人称</a> 的爆料<sup class="ss-footnote" href="" title="这是目前在公开平台能找到的最早曝光截图的用户。" footnote-id="1">1</sup>，A14 芯片的跑分已经出现在 <a href="https://browser.geekbench.com/v5/cpu/4006878" target="_blank">Geekbench 数据库</a> 中，单核分数 1583，多核分数 4198，比 A13 的分数（1336、3569）要高，A14 单核分数甚至超过了 A12Z 的 1118，但多核分数则比 A12Z 的 4564 要低。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/a5e8d12b5f40da30fd7c5f0b62c88aa3.png"><figcaption>图 / Geekbench</figcaption></figure><h3>屏幕：全机型装备 OLED，可能还有高刷新率</h3><p>今年的 4 款新 iPhone 都将使用 OLED 屏幕，iPhone 12 mini 和 iPhone 12 的屏幕大小为 5.4、6.1 英寸，iPhone 12 Pro 和 iPhone 12 Pro Max 的屏幕大小为 6.1、6.7 英寸，6.7 英寸的 iPhone 12 Pro Max 也会成为迄今为止屏幕最大的 iPhone。</p><p>此外，新的屏幕还有可能使用高刷新率技术，使画面效果更加流畅，Jon Prosser 在 Twitter 上 <a href="https://twitter.com/jon_prosser/status/1298363862568312832" target="_blank">曝光了</a> 几张新 iPhone 的系统截图，可以看到测试系统中出现了自适应刷新率的开关（Enable Adaptive Refresh Rate），能根据屏幕显示内容自动决定是否开启高刷新率。</p><p>但是高刷新率会造成续航能力下降，因此也有报道称苹果可能不会在 iPhone 12 上使用高刷新率，因此这个问题很可能要等到正式发布时才能揭晓。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/09/07/06ea4222f9c42e77968a26bed3826ecc.jpg"><figcaption>图 / Jon Prosser（Twitter）</figcaption></figure><h3>摄影：夜间摄影升级，Pro 系列或将配备 LiDAR</h3><p>苹果今年发布的新款 iPad Pro 配备了新的 LiDAR 激光雷达，能通过测量光触及物体并反射回来所需的时间来确定距离，提高 iPad Pro 的 AR 效果。而这项技术也会出现在新款 iPhone 上，据彭博社报道，至少会有一款机型——iPhone 12 Pro Max 配备 LiDAR。</p><p>而之前 Jon Prosser 曝光的系统截图中，也出现了 LiDAR 的相关选项介绍（Enable LiDAR CA），LiDAR 将在视频和夜间模式下提供辅助对焦和物体检测功能。</p><p>此外还可以在截图中看到，新款 iPhone 也将会升级夜间模式成像质量（Enable Enhanced Night Mode），并可能提供 4K@120FPS、4K@240FPS 慢动作拍摄（Enable Video Modes）。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/09/07/f35f2c7cbc480348cab30bbbb6231c3b.jpg"><figcaption>图 / Jon Prosser（Twitter）</figcaption></figure><p>根据数码博主 @Kang 的 <a href="https://weibo.com/1694917363/Joo2j8yzl" target="_blank">最新爆料</a>，iPhone 12 mini 和 iPhone 12 的后置摄像模组相同，但 iPhone 12 Pro 和 iPhone 12 Pro Max 的模组也有区别。</p><p>其中平价版的 iPhone 12 mini 和 iPhone 12 均为后置双摄（广角 + 超广角），iPhone 12 Pro 和 iPhone 12 Pro Max 都是后置三摄（广角、超广角、长焦）+ LiDAR 光学雷达，并配有全新七镜式广角镜头。但 iPhone 12 Pro 为 52mm 长焦镜头，支持 4 倍光学变焦，而 iPhone 12 Pro Max 则为 65mm 长焦镜头，支持 5 倍光学变焦。</p><p>@Kang 还提到四台手机的镜头光圈都提升至 ƒ/1.6，但没有明确指出是哪一个镜头。</p><h3>配件：新款数据线，没有 EarPods 耳机</h3><p>配件方面，由于苹果在上个月发布的新款 Apple Watch 中已经不再附赠充电头，新款 iPhone 很有可能也不再提供充电头，并推出一款新的 20W 快充充电头供用户额外付费购买。据<a href="http://www.chongdiantou.com/wp/archives/54311.html" target="_blank"> 充电头网</a> 爆料，包装盒内会随附一根 USB-C to Lightning 充电线，充电线外层采用编织设计增加耐磨度。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/09/07/f048ec22f139b9f67e6d2186888ed97d.jpg"><figcaption>图 / 充电头网（微博）</figcaption></figure><p>此外，以往随附的 EarPods 有线耳机可能也不再提供，在之前 YouTube 频道 <a href="https://www.youtube.com/user/ConceptsiPhone" target="_blank">ConceptsiPhone</a> 制作的包装盒托盘渲染图中也显示没有提供放置充电头和耳机的位置。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/09/07/4318fdfc8a63d4bc1b906c84e4f2a72a.jpg"><figcaption>图 / Ran Avni（YouTube）</figcaption></figure><h3>发售日期 &amp; 售价</h3><p>综合目前的爆料信息来看，iPhone 12 mini 和 iPhone 12 的起步容量为 64GB，而 iPhone 12 Pro 和 iPhone 12 Pro 的起步容量则为 128GB，受到产能各方面的影响，新款 iPhone 即使在本月开售，距离大家实际能拿到产品可能也需要一段时间，此前有参与「年年焕新计划」的用户也会发现苹果将升级注册日期推迟了 2 个月。</p><p>根据数码博主 @Kang 的 <a href="https://weibo.com/1694917363/Joo2j8yzl" target="_blank">最新爆料</a>：</p><ul><li>iPhone 12 mini 起售价 699 美元，颜色有黑色、白色、红色、蓝色、绿色</li><li>iPhone 12 起售价 799 美元，颜色有黑色、白色、红色、蓝色、绿色</li><li>iPhone 12 Pro 起售价 999 美元，颜色有金色、银色、石墨色、蓝色</li><li>iPhone 12 Pro Max 起售价 1099 美元，颜色有金色、银色、石墨色、蓝色</li></ul><p>发售时间方便，结合 @Kang 的爆料和以往的发售惯例（每周五开始预定及发售）：</p><ul><li>iPhone 12 mini：11 月 6 日预定，11 月 13 日发售。</li><li>iPhone 12：10 月 16 日预定，10 月 23 日发售。</li><li>iPhone 12 Pro：10 月 16 日预定，10 月 23 日发售。</li><li>iPhone 12 Pro Max：11 月 13 日预定，11 月 20 日发售。</li></ul><p><strong>关联阅读：</strong><a href="https://sspai.com/post/56744" target="_blank">连续三年参加「年年焕新」之后，谈谈这个「半价换 iPhone」的计划值不值</a></p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/4a6e75551b6767871656d22a2e0ecffd.png"></figure><h2>AirPods Studio：头戴式主动降噪，佩戴时无需区分左右</h2><p>AirPods Studio 盛传已久，目前消息普遍认为这款耳机将会在本月随 iPhone 12 一同发布。彭博社曾在今年 4 月<a href="https://www.bloomberg.com/news/articles/2020-04-16/apple-developing-high-end-headphones-with-interchangeable-parts">报道</a>，AirPods Studio 是一款头戴式耳机，或许将拥有两个版本。其中之一是使用类皮质纤维的高端版，另一个款则偏向运动，采用透气材料，整体也更加轻盈。</p><p>在功能体验上，AirPods Studio 或具备主动降噪能力，降噪模式与 AirPods Pro 类似。AirPods Studio 还会配备一项与 AirPods 佩戴检测类似的头颈检测功能，该功能会自动检测用户是将耳机戴在头上还是挂在脖颈上，进而自动暂停或播放音乐。</p><p>Jon Prosser <a href="https://twitter.com/jon_prosser/status/1306281069382172677" target="_blank">表示</a> AirPods Studio 机身会采用皮革 + 金属材质，配备 USB-C 接口，而且在佩戴时无需区分左右耳。之所以可以做到不分左右，@L0vetodream <a href="https://twitter.com/L0vetodream/status/1307578479458709505" target="_blank">表示</a> 是因为 AirPods Studio 会内置 U1 芯片。U1 芯片首次出现在 iPhone 11 系列中，它采用超宽频技术，让设备具备空间感知能力，可以感应到附近其他配备 U1 芯片的设备，并准确判断出彼此的位置关系。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/49626fa0b15476da85452122c32832bc.jpeg"><figcaption>AirPods Studio 渲染图（图 / Jon Prosser）</figcaption></figure><h2>AirTags、迷你版 HomePod、新款 Apple TV</h2><p>AirTags 是苹果将会推出的一款蓝牙追踪设备，可以与用户的 iOS 设备自动配对。配对完成后，用户就能在手机端查看每个 AirTags 的位置，进而通过定位寻找物品。</p><p>苹果或许会将 AirTags 的介面与 Find My app 相互整合。在查找物品时，苹果或许还会利用 AR 技术将现实场景和蓝牙定位融合在一起，便于用户更直观地寻找目标。最新一代 iPhone 搭载的 U1 芯片已经允许设备通过指向特定方向来相互配对和传输数据，该技术也将与 AirTags 形成联动。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/a1b2a121de2753c93ab8c9cd95760a45.jpeg"><figcaption>AirTags 渲染图（图 / Jon Prosser）</figcaption></figure><p>如果用户的 AirTags 丢失，则可以开启丢失模式。在该模式下，其他 iPhone 用户靠近该物品后会弹出提示，申请获得用户的联络方式，以便归还丢失的物品。</p><p><a href="https://www.macrumors.com/2020/03/09/airtags-cr2032-battery-rumor/">MacRumors</a> 表示 AirTags 将采用 CR2032 纽扣电池供电，平均每颗电池可以供电长达一年之久。AirTags 预计售价在 25 到 35 美元之间。</p><p>据彭博社 <a href="https://www.bloomberg.com/news/articles/2020-09-01/apple-targets-75-million-5g-iphones-for-fall-product-blitz">报道</a>，苹果正在研发一款新的 Apple TV，将拥有改进后的遥控器和更快的处理器。新款遥控器可能会包含一个类似「查找我的 iPhone」的新功能，当遥控器在室内丢失时，可以通过定位找到。此外还会有一款售价更低的 HomePod 发布，和现有 HomePod 相比，平价版 HomePod 减少了内置音频单元的数量。@Kang 在爆料汇总指出，HomePod mini 售价 99美元，内置 3.3 英寸喇叭，S5 处理器。大部分地方为 11 月发售，国内发售时间暂不确定。</p><p style="margin-left:0px;">&gt; 下载少数派&nbsp;<a href="https://sspai.com/page/client">客户端&nbsp;</a>、关注&nbsp;<a href="https://sspai.com/s/J71e">少数派公众号&nbsp;</a>，第一时间获取苹果新产品资讯 📱</p><p style="margin-left:0px;">&gt; 实用、好用的&nbsp;<a href="https://sspai.com/mall/class/28" target="_blank">正版软件</a>，少数派为你呈现&nbsp;🚀</p><p>© 本文着作权归作者所有，并授权少数派独家使用，未经少数派许可，不得转载使用。</p>
➜升级「真香」的 RTX 30 系显卡后，你能得到什么？
https://sspai.com/post/63057	27406
<p>9 月 2 日，Nvidia 终于发布了大家翘首以盼的 RTX 30 系列（安培架构）的显卡。尤其是 RTX 3070，比起上一代的显卡王者 RTX 2080Ti，在游戏里平均帧率高出 8% 的基础上，价格却低了整整一倍。</p><p>虽然通过 Steam <a href="https://store.steampowered.com/hwsurvey/videocard/">最新的显卡数据</a> 来看，GTX 10 系在 PC 玩家群体中依然是主流，随着下半年游戏潮的到来，《赛博朋克 2077》《看门狗：军团》《消逝的光芒 2》等等支持实时光追的游戏会越来越多；加上即将到来的「双十一」购物季，对于老用户、尤其是坚守在 10 系显卡的用户来说，剁手升级的时间似乎已经到了。</p><p>那么什么是实时光线跟踪，传统游戏是怎么打造光照效果的，升级 RTX 显卡能带来什么，RTX 30 系列的实际性能到底如何？在这篇文章中，我们就来对上面这些问题进行梳理。</p><h2>传统的游戏光照效果是如何实现的</h2><p>根据初中所学习的生物和物理知识，我们之所以能看见东西是因为光源发出的光在传播中遇到了不同材质的物体，产生了反射、折射、漫反射、散射等光学现象，这些不同的光学效果带来的最后一部分光刺激到了人眼视网膜上的感光细胞，我们才得以看到不同颜色的物体。</p><p>所以不同材质的物体从相同角度来看给我们的观感不一样，相同材质从不同角度看过去的感觉也会不一样。在没有光或者光线很暗的时候，我们也很难看清楚东西。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/bd5c6f30929fbef40e06c8b345c945e6.png"><figcaption>真实环境的光线远比游戏复杂 图片来自 @unsplash</figcaption></figure><p>和现实世界不同，传统的游戏世界在重现这种光照效果时更加注重「最终效果」。我们不妨从两个方面来理解传统游戏世界的光照实现方式：</p><p><i>P.S. 我并非专业游戏开发从业者，也对图形学没有深入研究，所以只能简单地介绍下原来游戏里是怎么处理光线的，如果我有哪方面解释错误欢迎大家在评论区指正。</i></p><p>首先，现代 3D 模型实际上都是通过三角形构成的，这是因为：</p><ul><li>三角形是最简单的多边形，少于3个点就不能成为一个面。所以通过三角形可以节约算力。</li><li>三角形必然在同一个平面内的，4 个或以上的点的多边形不一定在一个平面内，多余的点可能在这个面之上或者之下。所以通过三角形可以减少差错。</li><li>除了从三角形的边看三角形、三角形会变成线段以外，三角形无论从其他角度来看都是三角形。所以通过三角形可以在必要的时候直接忽视。</li></ul><p>同时三角形的面数决定了模型的精细程度，模型精度越高，三角形数目也就越多，性能开销也就越大。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/e305edc96383dac096bdf9da355c8a40.png"><figcaption>由三角形构成的模型，越复杂的模型也越精细</figcaption></figure><p>接下来，我们要知道什么是「光栅化」。</p><p>由于我们的屏幕是一个二维的平面，但是大部分的游戏模型却都是三维的，为了能让三维的模型正确显示在二维平面上，我们就需要通过一系列的过程去转换它们：</p><ul><li>读取模型的顶点，并根据顶点画三角形</li><li>将三角形用<strong>近似连点描边</strong>的方式转化成屏幕上的像素（三维坐标系可以是小数，而屏幕二维坐标只能是整数，这也是模型最后出现锯齿的元凶）</li><li>根据算法计算屏幕像素点到底是在三角形内还是三角形外。在三角形内部的，就上色，在三角形外部的，就不上色。</li><li>最后判断这个三角形哪些部分被前面其他三角形遮挡了，对于遮挡的部分就不需要上色，来减少不必要的性能开销。</li></ul><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/6c560b1f5902d70bf29709f02344791c.png"><figcaption>光栅化工作原理</figcaption></figure><p>这个整个过程我们就叫它「光栅化」，通过「光栅化」我们就可以完美地将创作者想要呈现的画面呈现出来，同时游戏里的光的实现也是在「光栅化」这个过程里实现的，只需要对三角形内部的像素进行额外的上色步骤即可：</p><p>首先模型的三角形都有对应的固有颜色（皮肤有固有的肤色、头发有固有的发色），所以将模型转化到二维像素以后，可以通过每个三角形的颜色为每个屏幕上的像素分配一个初始颜色值。接下来要根据场景里的其他光源来进一步的像素处理来改变像素的颜色，最后还需要根据纹理（皮革有皮革的纹理，布料有不同的材质）对像素做最后的处理，进而生成应用于像素的最终颜色。</p><p>我知道这个过程对大多数人来说都很抽象，我换个更生动形象的说法来说，基于光栅化的游戏光线处理，实际上是<strong>你看到的画面里所有的物体在自行发光</strong>，而不是和生活中一样通过折射、反射等手段传递光线。这也就是我们在上面所说的以渲染「最终效果」为主要手段。</p><p>光栅化的优点在于可以足够快，程序员可以预先写好光线的程序来处理小面积的光线，还可以制作光照贴图，在需要的时候和环境再进行渲染呈现（静态光照效果）来减少处理压力；但是缺点也很明显：<strong>不够真实</strong>，比方说游戏中的物体投影大部分时候都是一整块颜色相同的区域（阴影贴图），但是我们仔细观察生活会发现由于光的复杂性实际上的投影由近到远是越来越浅的。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/3911cf5c5545ca9be223ac8c2c6a99b9.png"><figcaption>投影和更接近真实的投影 图片来自 unreal 引擎官网</figcaption></figure><p>更多关于光栅化不够真实的更多例子可以看 <a href="https://docs.unrealengine.com/zh-CN/Engine/Rendering/LightingAndShadows/RayTracedDistanceFieldShadowing/index.html">这里</a>。</p><h2>光线追踪：用更现代的技术再现光线</h2><p>相比之下，实时光线跟踪可以营造比传统处理方式更加真实的光线，它<strong>通过逆向跟踪与假想照相机镜头（或者眼睛）相交的光</strong>作为工作原理，来实现对光线的实时追踪。</p><p>逆向跟踪远比真实地模拟光线相互作用的效率要高很多，因为大部分的光经过多次反射会逐渐消失，最后也不会进入眼睛，<strong>减少不必要的模拟</strong>会让最后的计算压力小很多。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/1c32781ae0ce85c6326f1ef99477d813.png"><figcaption>通过逆向跟踪实现的实时光线跟踪</figcaption></figure><p>实时光线跟踪技术最终的产物大家或多或少也都接触过了，电影院里能看到的不少好莱坞大片，在特效制作过程中其实都会用到光线追踪技术，最终生成以假乱真的特效场景——这背后往往需要以亿为单位的庞大运算量，每一帧的画面都需要高性能计算机花费数小时的运算。而这仅仅是在设计好一切之后的视觉运算，相比于电影提前设计好了场景和环境的光线计算，游戏的随机性显然更大，实时光线跟踪的实现难度自然也更高。</p><p>那么如何把光线跟踪引入到游戏中呢？</p><p>作为第一个将光线跟踪技术引入的显卡，Nvidia 在 RTX 20 系列中专门设计了几组 RT Core 来加速逆向跟踪光线的过程，比起 GTX 10 系列，RT Core 能够在实时光线跟踪这件事情上拥有更好的性能，表现在游戏中就是，开启实时光线跟踪以后 RTX 20 系列的显卡平均帧数会更高。</p><p>具体而言，RTX 在游戏中实时光线跟踪主要有三种不同的实现方式：</p><ul><li>阴影</li><li>高级反射</li><li>全局光照</li></ul><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/467087d5e112c5097e8689e091718c6b.png"><figcaption>仅阴影</figcaption></figure><p>仅阴影的代表游戏就是《古墓丽影》，这也是实时光线跟踪最简单的实现方式，<strong>只需要确定动态光源的数量和位置</strong>就可以给游戏带去动态阴影的效果，在任何的表面和环境下都能获得逼真自然的阴影效果。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/104318ca6356e2b3065ed6c8d34a95a9.png"><figcaption>上：未开启光追；下：开启光追，人物有了更真实的投影</figcaption></figure><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/8256e01316a7c8d117b80ee307d7d2e3.png"><figcaption>高级反射</figcaption></figure><p>高级反射的代表游戏是《战地 5》，<strong>光线需要实时跟踪场景里的所有物体</strong>才能正确精准地表现出反射效果，所以很多时候会造成很大的计算压力，因此这里往往还会引入传统的反射处理方法：屏幕空间法，只要画面中你能看到的物件不出现、被遮挡或是不可见，就不会产生反射。这也是为什么有些游戏中镜子看不见背后的人的原因。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/89580acb5a5a3ff17dd738707d48db36.png"><figcaption>上：开启光追；下：未开启光追，小汽车更融入环境里了</figcaption></figure><figure class="image ss-img-wrapper"><img src="https://www.nvidia.com/content/dam/en-zz/Solutions/geforce/news/geforce-dxr-ray-tracing/global-illumination-dxr-explainer.png" alt="https://www.nvidia.com/content/dam/en-zz/Solutions/geforce/news/geforce-dxr-ray-tracing/global-illumination-dxr-explainer.png"><figcaption>全局光照</figcaption></figure><p>最复杂的实时光线跟踪方式则是实现全局光照，《地铁：离去》和《控制》都利用了实时光线跟踪去实现全局光照。<strong>无论是光源、反射还是投影都是实时光线跟踪计算得到的</strong>，这可以进一步提高光照的准确度，更好地烘托游戏场景和氛围。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/5354ed59fddc193c6aa298449662378f.png"><figcaption>上：未开启光追，下：开启光追；房间内的光照更为准确，给人的感受更为真实</figcaption></figure><p>但是实现全局光照的压力真的是太大了：在没有 RT Core 的 GTX 系列的显卡上打开《地铁：离去》的实时光线跟踪，1080Ti 的表现直接从「高刷模式」掉到了「电影级画质」，帧率从 149 掉到了 38。</p><p><a href="https://docs.unrealengine.com/zh-CN/Engine/Rendering/RayTracing/index.html">进一步了解实时光线跟踪技术和传统技术在最后营造的画面上有什么不同。</a></p><p>所以正如前面提到的电影工业里的实时光线跟踪十分考验计算能力一样，即便有 RT Core 这样的计算核心进行加速，在原生分辨率下开启实时光线跟踪也会带来非常严重的帧率下滑；受限于成本， Nvidia 也不可能无限制地堆砌 RT Core 数量（不然就真的没几个人买得起了）。</p><p>有没有什么办法在不降低分辨率的情况下仍能获得稳定的帧率呢？</p><h2>DLSS：让高分辨率光追成为可能</h2><p>既然高分辨率不能达到稳定的帧率，那不如先降低分辨率渲染，再用算法提升到较高的分辨率，这样不就高分辨率和稳定帧率兼得了嘛。</p><p>没错，这其实也是目前大部分游戏机的处理 4K 画面输出的办法。但是用什么算法提升分辨率呢？</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/be512d9a39ff79f010cb1768ad9e9c76.png"><figcaption>图片来自知乎 @一疼 ETN</figcaption></figure><p>很多人会想到的第一个方法可能是插值技术。借助插值，我们可以很轻松地将 1080P 画面提升至 4K 分辨率，但简单插值效果并不好，对游戏这种特殊的渲染内容而言，还会带来额外的锯齿。</p><p><strong>所以 Nvidia 选择了用深度学习去计算画面</strong>，也就是我们看到的 DLSS 技术。</p><p>DLSS 的全称是 Deep Learning Super Sampling（深度学习的超采样），它主要通过 RTX 20 系列引入的 Tensor Core 硬件加速了深度学习，来对<strong>实时</strong>渲染的图片实现非常高质量的超分辨率。</p><p>在 RTX 30 系列发布以前，DLSS 2.0 就已经发布了，对比上一代的 DLSS 有如下改进：</p><ul><li>4 倍的实时超采样</li><li>2 倍的处理速度</li><li>通用模型</li><li>媲美甚至超越原生分辨率的画面</li></ul><p>4 倍的实时超采样，让我们在一个极低的分辨率下就可以获得一个高分辨率，比方说只需要渲染一个 540P 的画面即可生成一个 1080P 的最终画面，大幅度减少了显卡压力。加上全新的算法方式，最后获得甚至可以超越原生 1080P 的画面。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/11e31d9fb501e77a40d3091b6f39689a.png"><figcaption>图片来自知乎 @文刀秋二</figcaption></figure><p><strong>高达 2 倍的处理速度</strong>，主要体现在一段时间内可以处理的帧数会更多了，搭配 4 倍的实时超采样，最后的结果就是渲染的性能会暴涨游戏帧率直线上升。以《控制》为例，4K 分辨率下光追效果全开（全局光照），直接把 2060 的 8 FPS 提升到了 36 FPS，让 PPT 有了可玩性，堪称魔法。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/4cf7c1ace028d9a356b1ffdf7cb5df6e.png"><figcaption>图片来自知乎 @文刀秋二</figcaption></figure><p><strong>而使用通用模型</strong>可以快速在多个完全不同的场景、引擎和风格的游戏中部署 DLSS，让所有的游戏利用同一个神经网络实现高质量的超采样。</p><p>本来在游戏图形领域，性能和画质绝对是成反比的，要想要更好的画质，就一定要牺牲性能。而通过 DLSS 2.0 这种鱼和熊掌兼得的革命性技术，我相信原生分辨率渲染输出很快就会变成过去式，<strong>超采样的画面不仅不差，反而可能会更好</strong>。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/10/09/article/10f1693a9528e9efd1ebef5233cb9dd6"><figcaption>左：未开启 DLSS 的原生 1080P，右：开启 DLSS 的 1080P</figcaption></figure><h2>那 RTX 30 系列显卡怎么买？</h2><p>在上一代 RTX 20 系列显卡推出以后，我们就已经见识到了游戏实时光线跟踪带来的魅力。而这次更加令人瞩目的是 Nvidia 宣称 RTX 3080 有 2 倍于 RTX 2080 的性能，价格还只需要 700 美元，对比RTX 2080 推出的时候售价高达 800 美元的售价，这根本就是加量反而还降价了。</p><p>等等，真有「2 倍性能」那么夸张吗？</p><h3>RTX 3080 提升了多少？</h3><p>首先，聊聊所谓的 RTX 3080 对比 RTX 2080 提高了的 2 倍性能这一点，在 <a href="https://www.bilibili.com/video/BV1vh411R7Lg">LTT 视频</a>中 Nvidia 表示这个 2 倍专指《雷神之锤 2 RTX》和《我的世界 RTX》两个游戏下的性能提高了 2 倍，另外值得一提的是这两个游戏的光追都是全局光照。</p><p>那么 RTX 3080 性能到底怎么样：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/cb00908e8784c655bccb8455badd9d7b.png"><figcaption>图片来自 LTT&nbsp;</figcaption></figure><p>在 2K 原生分辨率下进行实时光追，RTX 3080 不仅和定位相同的 RTX 2080 比提升了 20%~75% ，同时也比价格更高的 2080Ti 也快了不少。</p><p>而在 4K DLSS 2.0 分辨率下，作为现在「显卡杀手」的微软模拟飞行 2020，RTX 3080 跑出了 41FPS 的优秀成绩，远比 2080 和 2080Ti 强上不少。对于即将入手非公版 3080 的我来说，终于可以安安静静地开飞机了。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/8928c0811e4915de5a6232e3ba066f2a.png"><figcaption>图片来自 LTT&nbsp;</figcaption></figure><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/e912ea204d831b99951a6d70fb957910.png"><figcaption>图片来自 LTT</figcaption></figure><p>在 4K DLSS 2.0 分辨率下打开实时光追进行游戏，3080 最低也能够保证「电影级帧率」，虽然看起来并不好看，但是和上一代的旗舰对比足够了，况且还有一个能以 8K 分辨率运行游戏的 3090 呢。</p><p>关于 RTX 3080 的完整测试可以点击 <a href="https://www.bilibili.com/video/BV1vh411R7Lg">此处</a> 观看，这里结合 LTT 的视频、超能网的<a href="https://www.expreview.com/75997.html">测评</a>以及 TECHPOWERUP 的测评，简单总结下和 RTX 2080 比性能有多少提升：</p><ul><li>光线追踪开，DLSS 关：RTX 3080 ≈ 2x RTX 2080 ≈ 1.5x RTX 2080 Ti</li><li>光线追踪开，DLSS 开：RTX 3080 ≈ 1.8x RTX 2080 ≈ 1.37x RTX 2080 Ti</li><li>光线追踪关 ( 或不支持 ) ：RTX 3080 ≈ 1.67x RTX 2080 ≈ 1.34x RTX 2080 Ti</li></ul><p>所以，虽然一般情况下 RTX 3080 很难达到 RTX 2080 的两倍，但是它的提升幅度仍然非常可观，跑起游戏来真的是非常强劲，加上今年即将到来的游戏大部分都会支持实时光追技术，看起来 RTX 30 系列非常值得入手。</p><h3>价格差距那么大，买哪款？</h3><p>如果你关注 RTX 3080 的非公版首发价格，就会发现同型号首批 30 系显卡的首发价格从 5500 元~7500 元不等，价格差距非常大。</p><p>其实不止 RTX 3080，其他显卡也是这样——虽然核心都是 RTX 3080，但是显卡核心周围的板载电容、散热设计等等，都会导致显卡价格出现差距。一般来说，一张显卡的价格受下列几个因素影响：</p><ul><li>芯片的基础价格：RTX 3070 核心和 RTX 3080 价格就不一样</li><li>芯片体质：更好的体制意味着核心可以更容易 Boost 到更高的频率，意味着可以在部分复杂场景里保持更高的帧率；或是能够保证长期超频使用下的稳定性。</li><li>散热设计：更好的散热设计意味着核心可以更容易停留在更高的频率，意味着可以在部分复杂场景里保持更高的帧率。或者在正常情况下保证更静音的体验，有谁会不爱静音呢。</li><li>用料做工：电容的用料、电容的多少也会影响到显卡的性能和稳定性，尤其是超频后的稳定性。像是有的适用于 ITX 主板的短卡，因为工艺集成高所以更贵。另外像是这次 3080 非官版系列也有双 8pin 和三 8pin 供电的区别。</li><li>外观设计：有些用户喜欢更炫酷的外观，像是显示屏、发光元件，这部分的价格也不便宜；而有些特殊配色要价也不便宜。</li><li>品（xing）牌（yang）溢价：部分品牌也是有一定比例的品牌溢价的，当然也确实有很多人愿意埋单。</li></ul><p>所以某张显卡到底价值多少，不仅要看纸面数据，还得结合我们看不见的各种因素综合考虑。</p><h3>价格</h3><p>预算是第一要义，由于显卡定价的因素过多，关于这个方面我只能说在购买的时候一定在有预算的基础上再有一个购买目标，是更喜欢炫酷的外观还是偏好静音，这样可以快速挑选出合适自己的几张显卡，搭配着拆解或者测评，来决定最后的选择。</p><p>另外由于这次产能有限，如果不是真的很急的话，<strong>不要急着买有溢价的显卡</strong>。</p><h3>尺寸</h3><p>购买显卡的时候还需要考虑机箱塞不塞的下这个体积的卡，比方说你一个 ITX 机箱一般来说肯定塞不下 ATX 尺寸的显卡的，这个一般在搜索时带上 ITX 这样的关键词就可以避免了。</p><p>显卡的厚度也会影响到能不能正常使用，这次 RTX 3080 有的是占据三槽位的，有的是则是两槽位的，三槽位的在一部分主板上可能会挡住另外一个 PCI-E 槽，如果这个 PCI-E 槽有在使用的话，就只能选择购买两槽位的版本。</p><p>关于这点可以去主板官方去查询 PCI-E 槽之间的距离与显卡的厚度进行比较。</p><p>部分机箱的硬盘盒可能也会限制可安装显卡的长度，这点可以通过机箱说明书或者在机箱官网查询到。而对于购买了品牌机的人群来说，升级显卡的时候需要参照品牌机官网的说明，一般品牌机官网有详细的说明</p><h3>电源</h3><p>这次 RTX 30 系列整体功耗属实高了不少，电源到底要多少才比较合适呢？</p><p>这里要说个前提，显卡功率不是线性的，也不会像在软件里显示得那么平滑，而是会在短时间里冲到一个非常夸张的值再在短期间内回落。虽然电源能有一定的过载输出的能力，但是长期过载轻则游戏闪退黑屏系统不稳定，重则损伤电源甚至影响到电脑里别的部件，所以电源一定要买够功率才行。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/10/09/f44a34f2636074aa40bc4fb3882a8019.png"><figcaption>非常夸张的 3090 峰值功率，来自 fcpowerup</figcaption></figure><p>我这里引用 fcpowerup 的结果，在处理器是 i9-9900K 的时候，对于 <a href="https://www.fcpowerup.com/nvidia-3080-psu-compatibility/">RTX 3080</a> 来说，电源至少需要 750 W；对于 <a href="https://www.fcpowerup.com/nvidia-3090-power/">RTX 3090</a> 来说，电源至少需要 950W。满足这一要求即可安全稳定地进行游戏，而不会出现黑屏游戏闪退、电源损耗过大的情况，如果 CPU 等级更高的话还需要用更大的电源。</p><h2>小结</h2><p>上面其实已经提到，我这次其实也打算买一块非公版的 RTX 3080。所以文章的最后，我就简单分享一下我的具体选购思路吧，仅供参考。</p><ul><li>首先确定不买公版：公版的会把热风往 CPU 散热器那边吹，我用的又是风冷，怕 CPU 散热压力太大，所以我最终选择了非公。</li><li>接下来预算：期望预算和公版差不多，大概在 5500~5800 元左右搞定。</li><li>同时检查现有的硬件的兼容性：850W 的金牌电源足够了，机箱长度足够，主板空间也足够大。</li></ul><p>再去京东把所有的 RTX 3080 显卡和即将上架的显卡的显卡数据列出，顺便看看有没有测评能进一步完善数据无法体现出来的东西。再定一个目标帮助去掉不必要的选择：<strong>和公版性能差不多、没有 RGB、安静</strong>。</p><p>最后我选择了影驰 RTX 3080 金属大师，没过多的 RGB，风扇 RGB 可以关闭，整体风格比较硬朗。本来决定等价格回落点就是它了，不过现在听说未来 RTX 3080 还有 20G 显存版，所以我还是等等好了。</p><p>以上就是本文的全部内容，希望它能帮助到你。</p><p style="margin-left:0px;">&gt; 下载少数派&nbsp;<a href="https://sspai.com/page/client">客户端&nbsp;</a>、关注&nbsp;<a href="https://sspai.com/s/J71e">少数派公众号&nbsp;</a>，给你最接地气的实用干货 🍕</p><p style="margin-left:0px;">&gt; 实用、好用的&nbsp;<a href="https://sspai.com/mall/class/28" target="_blank">正版软件</a>，少数派为你呈现&nbsp;🚀</p><p>© 本文着作权归作者所有，并授权少数派独家使用，未经少数派许可，不得转载使用。</p>