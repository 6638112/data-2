➜一日一技 | 如何让 Windows 的共享打印机支持 AirPrint
https://sspai.com/post/63776	13298
<p>对很多办公室环境来说，局域网共享打印机往往都是刚需，而如果局域网内的设备大多为 Windows 设备，通过 <a href="https://support.microsoft.com/zh-cn/windows/%E5%85%B1%E4%BA%AB%E7%BD%91%E7%BB%9C%E6%89%93%E5%8D%B0%E6%9C%BA-c9a152b5-59f3-b6f3-c99f-f39e5bf664c3" target="_blank">网络共享</a> 的方式就可以轻松将所连接的 USB 打印机共享到局域网。</p><p>但对同一个局域网内的 Apple 设备而言，因为很多打印机的 Mac 驱动对 macOS Big Sur 的支持尚且存在问题，在上述局域网环境下想要使用由 Windows 设备共享打印机会变得非常麻烦。</p><p><strong>那能不能将 Windows 上的共享打印机转换成 AirPrint 打印机，让 Apple 设备也能接入并进行无线打印呢</strong>？答案是可以的。</p><h2>Step 1. 开启打印机共享</h2><p>首先，我们依然需要将 USB 打印机连接到 Windows 设备上，并且在网络中开启「网络发现」。</p><p>然后在 Windows 上打开「控制面板 &gt; 硬件和声音 &gt; 设备和打印机」，找到需要共享的打印机，点击右键选择「打印机属性」，最后在「共享」选项卡中勾选「共享这台打印机」。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/25/e91ae0b937d7094354e614b59d24f8a9.png"></figure><h2>Step 2. 配置「转接」服务</h2><p>我们需要在 Windows 上安装 <a href="https://support.apple.com/kb/DL999?viewlocale=zh_CN&amp;locale=zh_CN" target="_blank">Bonjour Print Services (Windows)</a>，这个 10 年前由 Apple 出品的小工具。借助它的 Bonjour 打印机向导，我们可以在 Windows 电脑上找到并配置启用 Bonjour 的打印机。这里我们主要用到的则是 Bonjour 的分享功能。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/25/b05f184d349430e34d16130cac2f327d.png"></figure><p>然后我们需要安装的是一个第三方配置工具 —— <a href="http://cdn.jaxov.com/wp-content/uploads/2010/11/Windows_AirPrint_Installer_iOS_5_for_x86_x64.zip" target="_blank">AirPrint Installer</a>，下载之后解压缩后会看到三个文件，首先我们使用管理员权限运行 <strong>AirPrint Installer.exe</strong>。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/25/ad7ebba77557f991701e3e8917907948.png"></figure><p>在主界面下点击 Install AirPrint Service 将无线打印服务安装进入系统服务项目中。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/25/2ae559ece7ac1da60cf553ef39192a27.png"></figure><p>接着我们选择 Service Startup&gt; Auto，然后点击 start，这样整个服务就已经完成启动了。</p><p>这里需要注意的是，窗口右侧的 AirPrint Auth 默认选择的是当前状态下已登录的 Windows 账号，如果你的使用场景是包含内网服务器（运行的是 Windows 服务器操作系统），那么在这里还可以开启来宾账号以实现后续的免密码打印。</p><h2>Step 3. 配置防火墙</h2><p>下面我们需要做的就是给这个 AirPrint for Windows 打上「补丁」：在前面解压缩的 AirPrint Installer 文件夹中找到 <strong>AirPrint iOS 5 FIX</strong> 对应的两个注册表文件，根据系统是 32 位还是 64位选择对应的版本并执行注册。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/25/c3edf75b45487d900c822bf43101bc83.png"></figure><p>然后我们打开「控制面板 &gt; 管理工具 &gt; 服务」，检查 <code>AirPrint</code> 以及 <code>Bonjour服务</code> 两个服务是否已经处于启动状态。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/25/8cb49b6f94915b3f31cbe7a173aad2f9.png"></figure><p>最后我们来设置网络防火墙，首先在「控制面板 &gt; Windows 防火墙」开启「打开允许程序或功能通过 Windows 防火墙」，然后检查列表中 <code>AirPrint for Windows</code> 和 <code>Bonjour 服务</code> 两项下，「家庭/工作」以及「公用」选项都已经勾选。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/25/05943113b47b3a55c952f957f2eabefa.png"></figure><p>同时，对于 Windows 10 或者 Windows Server 2016/2019 的主机，我们还需要额外的加入几个放行端口来保证 Apple 设备可以找到打印机：这里先找到「控制面板 &gt; 管理工具 &gt; 高级安全 Windows Defender 防火墙」，然后在「入站规则」的右侧点击「新建规则」。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/25/78cc1802e830eec749316f2684e965ee.png"></figure><p>在弹出的「新建规则向导」中，首先在「规则类型」中选择<strong>端口</strong>，然后在下一步的「协议和端口」中选择 <strong>TCP</strong>，在特定的本地端口中输入「<strong>5354</strong>」；在下一步的「操作」中勾选「允许连接」，然后后面全部默认点击下一步，最后设置一个特定的名称即可完成。</p><p>同样的办法我们需要设置三条规则，除了上面的 <strong>TCP 5354</strong> 端口之外，还需要放行 <strong>UDP 5353</strong> 端口以及 <strong>TCP 631</strong> 端口，这样防火墙方面算是全部设定完毕了。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/25/0412bdf3ecd57b53c7bdcbcd1abb8bd6.png"></figure><p><strong>最后，也是最重要的一步：重启 Windows</strong>。</p><h2>iOS 设备配置与测试</h2><p>先确保局域网中的 Mac 以及 iOS 设备和连接打印机的 Windows 电脑处于同一网段，然后我们首先先试一下 iOS 设备。</p><p>打开 Safari 浏览器后随便打开一个网页，点击分享按钮在弹出的分享菜单中找到「打印」，然后在「打印机选项」中点击「打印机」来选择打印机，如果能够看到刚刚设置好的 AirPrint 打印机就算成功了，选择打印机后输入Windows 账号密码（服务器开了来宾账号可以免密码）就可以实现隔空打印。</p><figure class="ss-imgRows" figcaption=""><img src="https://cdn.sspai.com/2020/11/25/9a01d546a6383d327b91ddfe700c194e.PNG" alt=""><img src="https://cdn.sspai.com/2020/11/25/2c7cf0d2268e1c90d56f0b9d8da7229e.PNG" alt=""></figure><p>macOS 上的设置也很简单，打开「系统偏好设置 &gt; 打印机与扫描仪」，然后点击右下角的添加按钮来添加打印机。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/25/6140de8b8ecc9070202fa69ebb72060a.png"></figure><p>在「添加打印机」中选择第一个选项卡，不出意外的话环境会自动搜索到上面设置好的 AirPrint 打印机，选择并点击添加即可。</p><figure class="ss-imgRows" figcaption=""><img src="https://cdn.sspai.com/2020/11/25/425db91943e7fdb28860dd4c04501230.png" alt=""><img src="https://cdn.sspai.com/2020/11/25/ab962e9baa0f3b3d3d8f288fc1ad09a7.png" alt=""></figure><p>之后你就可以在「打印机和扫描仪」中看到这个 AirPrint 打印机的状态了，打开一篇文档然后尝试打印吧。</p><p>上述方法在以下系统下测试通过：</p><ul><li>Windows 主机：Windows Server 2008 R2</li><li>macOS Big Sur</li><li>iOS 14</li></ul><p style="margin-left:auto;">&gt; 下载少数派 <a href="https://sspai.com/page/client">客户端 </a>、关注 <a href="https://sspai.com/s/J71e">少数派公众号 </a>，发现更多实用技巧 🍃</p><p style="margin-left:auto;">&gt; 想申请成为少数派作者？<a href="https://sspai.com/apply/writing" target="_blank">冲！</a></p><p>© 本文着作权归作者所有，并授权少数派独家使用，未经少数派许可，不得转载使用。</p>