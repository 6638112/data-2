➜[送码] 实用性与趣味性兼具，把 Android 通知玩出花：全局弹幕通知
https://sspai.com/post/63606	15385
<p>为了保证日常通知不被垃圾信息淹没，近段时间 Android 平台上出现了一些通知过滤工具，比如 <a href="https://sspai.com/post/59502">通知滤盒</a> 和 <a href="https://sspai.com/post/60806">Buzzkill</a>，它们通过读取通知内容并匹配预设条件以达到过滤通知的目的。</p><p>同样利用这种思路，今天要介绍的全局弹幕通知则将手机变成了一个「B 站」，通知不再是冷冰冰的条幅而是飞来飞去的弹幕。不仅如此，它还有许多既好玩又实用的扩展功能，可以算是一个大而全的系统辅助工具。</p><p>下面让我们一起来看看它到底能做些什么。</p><h2>活用弹幕，重要消息灵活应对</h2><p>就核心功能来说，全局弹幕通知的使用方法与通知滤盒或 Buzzkill 几乎没有差别。根据实际需求，我们在设定好应用范围和触发条件，并执行「发出弹幕通知」操作，原本从顶部弹出的通知横幅变成弹幕。</p><p>例如我的需求是「Clyde 在微信催稿」时发出弹幕通知，就可以设定成图片中的样子。触发条件中也支持嵌套和正则表达式，方便用户实现更为复杂的需求。关于通过正则表达式处理通知的介绍，可以阅读 <a href="https://sspai.com/post/60536">这篇文章</a>。</p><figure class="image ss-img-wrapper image_resized" style="width:450px;"><img src="https://cdn.sspai.com/2020/11/14/article/aaf11d2bccc9d3e9686b1d86bc261e1c"></figure><p>​将通知样式变为弹幕可不仅仅是为了好玩，<strong>全局弹幕通知相当于在原有通知框架之上新增了更高的优先级：弹幕通知 &gt; 弹出通知 &gt; 免打扰通知</strong>。我们不妨类比一下弹幕视频网站。</p><p>弹幕视频网站在视频之上展示弹幕评论，能够让眼睛同时接收两种内容。由于弹幕不会长时间驻留，不易大幅遮挡画面，并且主流弹幕网站都提供了多种过滤措施，能够兼顾网友们「视频和评论我全都要」的需求。而内容下方的评论区没有被弹幕所取代，这正好给评论进行了「分级」：弹幕与时间线相关所以优先级最高，对视频整体的评价与讨论次之，给用户充分的自主选择权。</p><p>正如这些网站一样，一般通知在弹出时会占用一部分屏幕区域，很容易在打游戏、看电影时造成遮挡、破坏沉浸感，而免打扰的「例外」功能颗粒度又不够细，难以为某一特殊内容「破例」，这时我们就可以借助弹幕的高优先级、低干扰、颗粒度细的特性，实现「Clyde 在微信催稿时，不管我在干嘛都提醒我」的需求了。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/14/article/c4f681ed728d56255a626abc234213bc"></figure><p>​当然，功能再强大也需要美丽的皮囊。在个性化方面，全局弹幕通知提供了气泡弹幕、图标弹幕、纯文字弹幕三种样式，每一种都有着丰富的自定义选项，购买高级版后能够额外获得更多「勐男必备」的气泡样式。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/14/article/5af9cd84f49b204defa183368793e845"></figure><p>​弹幕样式与各类判断条件并非绑定关系，你可以理解为创建了一个样式模板，在任何判断条件中都能调用。如果你也打算在玩游戏、看电影时使用，建议使用「无气泡文字描边样式」。</p><h2>丰富扩展，扩展通知功能</h2><p>既然使用逻辑相似，那么全局弹幕通知当然也可以过滤通知。我们只需要在「干哈」中选择「静音」操作，垃圾通知就不会突然弹出来打扰我们了。对于只需要看一眼就丢掉的通知，「自动移除」更加合适，它会触发弹幕通知但不会让内容驻留在通知栏，比如某些店铺发来的会员折扣。</p><p>国产手机系统的本地化足够优秀让它们在崛起之路上如虎添翼，就比如验证码提取和复制功能。如果你正在使用 Pixel 手机或「类原生」系统，可以试一下全局弹幕通知的「复制文本」功能，而借助条件嵌套和正则表达式，它还可以提取邮箱、地址等等更为复杂的内容。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/14/article/945261d3e533a4256b9a1efe429d388c"></figure><p>​手机搭载的语音助手可以实现通知播报，但每一次我们都需要唤醒它并说出指令才行。全局弹幕通知则能够实现基于条件判断的全自动播报。我们可以设定好相关条件，在需要时提前开启该功能。比如我正在厨房中大显身手、正在为宠物洗澡时，没办法腾出双手操作手机，就可以提前打开开关，这样如果出现了工作相关的内容，手机就能自动播报通知，方便我来判断是否需要立即回复。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/14/77769d9283ed071f6800b6be6f5183eb.png"></figure><p>全局弹幕通知还支持 Android 原生小窗功能，但考虑到部分第三方定制系统做了魔改，能否在你的手机上使用还需要大家自己尝试一下。</p><h2>更多「不务正业」的趣味特性</h2><p>虽然应用名称叫做「全局弹幕通知」，不过只看名字的话恐怕没人能想到它还可以跳过广告，不过目前应用内还没有提供太多预设条件。为了避免选择「所有应用」时误触发，我们可以使用内建的「事件查看器」提取事件、动作等信息，不懂 Android 系统的小白也可以一键添加到操作条件中。</p><p>与独立的广告跳过应用相比，全局弹幕通知里有着更加丰富的参数供我们自定义，不过对于一些图形化、组合化的按钮则无能为力，大家可以酌情选择。</p><figure class="image ss-img-wrapper image_resized" style="width:450px;"><img src="https://cdn.sspai.com/2020/11/14/article/448576353d460e4908fbd9fc9e670ffa"></figure><p>​另一个趣味功能就是当前大火的「充电提示音」，其实在 Android 上早已有许多方法能够实现。全局弹幕通知干脆将其做成了一个扩展功能，简单点击几下就能播放各种好玩有趣的提示音。利用这一功能，我们还可以针对某些特殊通知做特殊提示，比如女朋友撒娇想吃炸鸡、男朋友傲娇要买显卡……</p><figure class="image ss-img-wrapper image_resized" style="width:450px;"><img src="https://cdn.sspai.com/2020/11/14/article/016bc6514e4c5b1689c15aa2e3dfde3d"></figure><p>「指尖特效」则是单纯的手机美化功能，其实现原理则是利用 Android 系统悬浮显示权限，在点击按钮、链接等控件时展示动画。全局通知弹幕虽然只内置了一个爱心发射特效，但允许用户使用自定义 GIF 动图，我收藏的一些沙雕表情包终于派上用场了。</p><figure class="image ss-img-wrapper image_resized" style="width:452px;"><img src="https://cdn.sspai.com/2020/11/14/article/9654dede26b7b543fe85eab6651eaa09"></figure><p>​除此之外，全局弹幕通知还有其他扩展功能，例如音乐播放器控制、全局壁纸等，付费购买高级版还能够在内建的模板社区里一键添加常用规则，帮助用户快速上手。</p><p>借助 Android 强大、开放的特性，时下许多流行的手机玩法我们都可以实现，甚至获得比系统本身更加强大的管理功能。如果你也想要尝试一下全新的通知形式，可以前往 <a href="https://www.coolapk.com/apk/com.quan.barrage">酷安</a> 免费下载全局弹幕通知。</p><p>最后值得一提的是，全局弹幕通知的部分高级功能需要通过内购订阅或买断进行解锁，应用内永久买断价格 3 折优惠近期即将下架，有需要的朋友抓紧时间；另外，在本文评论区留下你对 Android 通知管理和全局弹幕通知的看法、体验或建议，<strong>我们将在一周后抽出 5 位读者送出由开发者提供的高级版激活码</strong>。</p><p>文章题图来自 <a href="https://www.raywenderlich.com/" target="_blank">raywenderlich</a></p><span class="ss-application" app-id="15823">&nbsp;</span><p style="margin-left:0px;">&gt; 下载少数派&nbsp;<a href="https://sspai.com/page/client">客户端&nbsp;</a>、关注&nbsp;<a href="https://sspai.com/s/J71e">少数派公众号&nbsp;</a>，发现更多实用 App 📱</p><p style="margin-left:0px;">&gt; 实用、好用的&nbsp;<a href="https://sspai.com/mall/class/28" target="_blank">正版软件</a>，尽在 <a href="https://sspai.com/post/63354" target="_blank">少数派「双十一」活动</a> 🚀</p><p>© 本文着作权归作者所有，并授权少数派独家使用，未经少数派许可，不得转载使用。</p>
➜macOS、iOS、iPadOS 跨平台应用，1 小时就能制作完成
https://sspai.com/post/63554	23270
<h3>Matrix 首页推荐</h3><p><a href="https://sspai.com/matrix">Matrix</a> 是少数派的写作社区，我们主张分享真实的产品体验，有实用价值的经验与思考。我们会不定期挑选 Matrix 最优质的文章，展示来自用户的最真实的体验和观点。</p><p>文章代表作者个人观点，少数派仅对标题和排版略作修改。</p><hr><p>故事发生在我今天坐等 Apple Silicon 芯片发布会的时候。看表还有一个多小时到发布会，干等着也没意义，索性用 Apple 为开发者提供的最新流程和技术，写个跨平台应用程序，带大家了解一下应用程序的开发流程。</p><p style="margin-left:0px;">本次发布会后，所有的 iOS 应用均会支持采用 M1 芯片的 Mac 产品线，目前开发者的应用上传界面已经明确说明，如下图所示。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/11/ee21960a384739c4e6dfc0d4557280fb.png"></figure><p style="margin-left:0px;">至于其运作原理，我已经在文章 <a href="https://sspai.com/post/60921" target="_blank">「ARM， AMD，英特尔」硬件科普及我见的未来</a>、 <a href="https://sspai.com/post/63431" target="_blank">Apple 发布会：新 Mac 会带来的改变</a>、 <a href="https://sspai.com/post/61274" target="_blank">为什么 ARM 版 Mac 运行效率很高？</a> 里从多个角度仔细讲解，不再赘述。</p><h2 style="margin-left:0px;"><strong>准备开发环境</strong></h2><p style="margin-left:0px;">本文所用操作系统位 macOS Big Sur 11.0.1 RC 准正式版，开发环境为 Xcode 12.2 RC 准正式版。使用编程语言为 Swift 和 SwiftUI。</p><h2 style="margin-left:0px;"><strong>开发什么？</strong></h2><p style="margin-left:0px;">考虑到时间紧张，开发一个完整应用是不现实了，不过还是可以做一个找一个有趣的开源动画，帮助大家在等待发布会的时候舒缓心情。我选用的是作者 Javier 制作的<a href="https://swiftui-lab.com/swiftui-animations-part1/" target="_blank">制作的一朵花的动画</a>，并在此基础上进行改动。下图是应用本文最终开发成果。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/11/5f93e4077803226ff45d4bc4936da003.gif"></figure><p style="margin-left:0px;">&nbsp;</p><h2 style="margin-left:0px;"><strong>开发步骤</strong></h2><p style="margin-left:0px;">本小节并非应用开发教程，只是我在边敲代码边写文章，对开发过程中重要时间节点的记录。</p><p style="margin-left:0px;"><strong>第 1 步 （距发布会还有 1 小时 54 分钟）：</strong>选择 Xcode 欢迎面板中的「Create a new Xcode Project」来创建一个新项目。接下来会弹出如下图所示的 Xcode 模版选择界面。</p><p style="margin-left:0px;">Apple 提供了一系列已经完成部分琐事后的成品模版以供使用，方便开发者快速进入创作状态。此处选择默认的「Multiplatform App」跨平台模版，并点击「Next」下一步。</p><p style="margin-left:0px;">平台模版是开发 iOS、iPadOS、macOS 的跨平台应用的优秀起点，后续你也可以在项目中根据实际需求为其添加 watchOS 等其它平台的支持。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/11/7c4fd18c41b14cfa3bc717e122fc0e14.png"></figure><p style="margin-left:0px;"><strong>第 2 步 （距发布会还有 1 小时 52 分钟）：</strong>在选择模版后，接着弹出的便是当前项目设置。你既可以在这里提供项目的详细信息，也可以轻度定制你的模版。我们将项目命名为 MacEvent。点击下一步并保存，新应用便创建完成了。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/11/35ee60f34b24c973740b7feb57b92719.png"></figure><p style="margin-left:0px;"><strong>第 3 步 （距发布会还有 1 小时 46 分钟）：</strong>创建好应用后，编辑一些与苹果发布会相关的文字。如下图所示，Apple 设计的 SwiftUI 界面开发语言非常好读，和我们正常说话时几乎一样的。</p><p style="margin-left:0px;">比如下图中的代码，指的是「文本是这些 Text，要大字体 .font(.largeTitle)，要加粗 .bold()，四周留有间距 .padding()」，大概就是这样。下图右侧的 iPhoen 12 Pro 设备，便是开发环境中的预览视图。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/11/f93dfc02422caef926928bcf023ca017.png"></figure><p style="margin-left:0px;"><strong>第 4 步 （距发布会还有 1 小时 32 分钟）：</strong>纯黑的字体不是很好看，可以考虑给它加一点渐变色，此时我去创建了一个 Helper 文件，往里加进去了一些辅助函数。接着打开 Sketch，找两个渐变色的色号添加至代码中。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/11/86ead83f5a34d56edce6070853568034.png"></figure><p style="margin-left:0px;">在 iPhone 12 Pro 的模拟器运行，看看效果，如下图所示。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/11/cb3995e0458eea16041ae0535125adc2.png"></figure><p style="margin-left:0px;"><strong>第 4 步 （距发布会还有 1 小时 25 分钟）：</strong>接下来就是把之前找到的动画放上去，复制已经写好的动画代码到文档中，顺便调整一下刚刚弄好的渐变文字的对齐。因为还要写这些文字，所以花的时间会更多一点。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/11/5e10bac12dd157244e57af57ea9bf49f.gif"></figure><p style="margin-left:0px;"><strong>第 5 步 （距发布会还有 1 小时 21 分钟）：</strong>觉得之前的渐变色太土了，而且是居中渐变，不满意。于是花了一点时间去调整了下渐变色和渐变的初始位置。下图中新渐变色起点改为了左上角。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/11/9f6d91871b0ec1d58395caf679895895.png"></figure><p style="margin-left:0px;"><strong>第 6 步 （距发布会还有 55 分钟）：</strong>应用现阶段好像有点无趣，缺乏与用户的交流。琢磨着可以增加一个提醒，让用户跟着动画来调整呼吸。这样的话就需要一个提示文字，加在动画下方，如下图所示。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/11/6d047ff9352244c7f0dd2b9477bcaaa4.png"></figure><p style="margin-left:0px;">此时的文字的动画显得比较突兀，我花了一段时间给它加一个边框。这个边框折腾完之后效果不好，又被我给移除了，耽误了一段时间。最终转而制作了简单的字体呼吸的缩放特效。</p><p style="margin-left:0px;"><strong>第 7 步 （距发布会还有 35 分钟）：</strong>剩下的时间不多了，考虑在底部加一个版权说明。这次是 Apple 官方的活动，所以找一个苹果图标。打开 SF Symbols 图标库，搜索并寻找 Apple 图标，如下，名称为 <code>applelogo</code>。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/11/a76d3c5ae8ad54d3c8dca1abc0c57475.png"></figure><p style="margin-left:0px;">完善一下版权说明部分的文字样式，设置为两侧对齐，并在中间加入了占位符，最终效果如下图。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/11/64dee434445bb955d9e4968774b46ad2.png"></figure><p style="margin-left:0px;"><strong>第 8 步 （距发布会还有 30 分钟）：</strong>在设置面板的兼容性设置中，确认该应用支持 Mac、iPad、iPhone。之后就可以在不同的设备上进行测试了，结果如下图。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/11/7cfc8d764139927a8d41641ea6ac6b7d.png"></figure><p style="margin-left:0px;">截一张应用在 Mac、iPad、iPhone 上运行的截图，应用至此制作完成。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/11/11/0727b955c9828569ee9783f03afff0a7.png"></figure><h2 style="margin-left:0px;"><strong>总结</strong></h2><p style="margin-left:0px;">作为一次发布会前夕的快速尝试，除去写文字和准备图片外，实际开发用时不到一小时。这个应用具备了跨平台运行、自适应设备尺寸、支持分屏模式、支持夜间模式等特性。如你所见，制作一个独立应用并没有大家想象的高门槛，只要有一个想法，把它表述出来即可。</p><p style="margin-left:0px;">若你你的脑海中肯定也有创意的想法想要实现，欢迎去阅读我正在制作的「<a href="http://link.zhihu.com/?target=https%3A//sspai.com/series/147" target="_blank">创作者的 iOS 独立开发指南</a>」。这是一份写给新人的系统性入门指南，你不需要学完了某个点再去找别的教程。文章独自成主题，可按照自由节奏阅读。</p><p>它包含商学知识、编程语言、应用设计、构思、推广等独特内容。若你想投资自己，或邀请朋友来阅读本课程，现在是最好的时候。本课程正享受少数派双十一活动（11 月 18 日截止），链接如下：</p><ul><li><a href="https://sspai.com/series/147/list" target="_blank"><strong>8 折购买课程</strong></a></li><li><a href="http://link.zhihu.com/?target=https%3A//sspai.com/series/147" target="_blank"><strong>课程简介</strong></a></li><li><a href="https://sspai.com/post/62148" target="_blank"><strong>试读：独立应用开发的完整流程</strong></a></li></ul><p>&gt; 下载少数派&nbsp;<a href="https://sspai.com/page/client">客户端&nbsp;</a>、关注&nbsp;<a href="https://sspai.com/s/J71e">少数派公众号&nbsp;</a>，了解更妙的数字生活 🍃<br>&gt; 想申请成为少数派作者？<a href="https://sspai.com/apply/writing">冲！</a></p>