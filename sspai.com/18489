➜让重装更快一点 —— 定制自己的系统映像
https://sspai.com/post/61917	32110
<h3>Matrix 精选</h3><p><a href="https://sspai.com/matrix">Matrix</a> 是少数派的写作社区，我们主张分享真实的产品体验，有实用价值的经验与思考。我们会不定期挑选 Matrix 最优质的文章，展示来自用户的最真实的体验和观点。</p><p>文章代表作者个人观点，少数派仅对标题和排版略作修改。</p><hr><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/1265ab581e98ccfb61fecbef901b34cf"><figcaption>令人窒息的提示</figcaption></figure><p>当系统卡顿、出现 Bug、电脑崩坏的时候，应该重启，重装，还是重买呢？</p><p>相信大多数网友对重装并不陌生了，PE 系统、系统重置、在线重装降低了重装系统的门槛，「重装大法」虽然可以解决 90% 的问题，简单、直接，但会破坏当前熟悉的工作环境与工作流程，重装后需要花费较长的时间重新搭建，倘若操作不当，还可能丢失一些重要的工（<s>学</s>）作（<s>习</s>）资料。即便是熟悉电脑的玩家，手动恢复重装后的系统设置、硬件驱动、软件安装与配置、还原资料至可用状态，也需要耗费数小时乃至数天才能完成，让人十分头疼。</p><h2>各类备份与恢复方式</h2><figure class="table"><table class=""><tbody><tr><td>&nbsp;</td><td>ISO 映像</td><td>GHO 映像</td><td>WIM 映像</td><td>ESD 映像</td></tr><tr><td>实现原理</td><td>基于分区Sector-based</td><td>基于分区Sector-based</td><td>基于文件File-based</td><td>基于文件File-based</td></tr><tr><td>分区信息</td><td>无</td><td>有</td><td>无</td><td>无</td></tr><tr><td>压缩率</td><td>低</td><td>低</td><td>中</td><td>极高</td></tr><tr><td>热还原</td><td>不支持</td><td>支持</td><td>间接支持</td><td>间接支持</td></tr><tr><td>热备份</td><td>不支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>增量备份</td><td>不支持</td><td>不支持</td><td>支持</td><td>支持</td></tr><tr><td>修改映像</td><td>不支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>便捷性</td><td>难</td><td>易</td><td>易</td><td>难</td></tr></tbody></table></figure><p><strong>Symantec™ Ghost</strong></p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/4a60c19910d17277213c8467315f1f76"><figcaption>Symantec™ Ghost</figcaption></figure><p>诺顿克隆精灵（Symantec Ghost），由 Binary Research 公司于 1996 年编写，后来在 1998 年 6 月 24 日被赛门铁克公司收购，扩展名为 ​gho​。2013 年 4 月 30 日起，赛门铁克将停止销售诺顿克隆向导。该软件能够完整而快速地复制备份、还原整个硬盘或单一分区。</p><p>相信许多 80 后、90 后朋友对「一键 Ghost」并不陌生 —— 蓝灰色的古老界面、黑色的小幽灵。通过将整块硬盘上的内容转换为 Ghost 映像，可以在任意电脑上实现磁盘对拷（Disk to Disk）、分区到分区（Partition to Partition）、硬盘 / 分区备份（Disk / Partition to Image）、硬盘 / 分区还原（Disk / Partition from Image）等功能。</p><p>因 Ghost 映像中未设置针对特定电脑、特定型号，无法验证还原的电脑是否为映像源的电脑，番茄花园、雨林木风、电脑公司、深度技术等公司曾借助「Ghost + 自动安装」实现傻瓜式重装，传播盗版系统，在装机圈中混得风生水起，「深受」用户们的追捧。但也因缺乏验证、无法跳过坏区块，随着微软的反击与技术更迭，Ghost 不再能胜任目前的系统备份与恢复工作。在 Symantec Ghost 退出人们的视野后，一些厂商基于映像备份的工作机制开发了适合当代系统的备份软件，如 Acronis True Image、傲梅轻松备份等，OEM 厂商也为自家的电脑配备了一键恢复系统，如联想一键恢复、Dell Factory Image Restore 等。</p><h3>WIM / ESD 映像</h3><p>除了 Ghost 映像备份这种方式外，我们还能够通过 Dism 来备份映像，或是使用 Easy Sysprep 定制系统映像。</p><p>WIM（Windows Imaging Format）是一种基于文件的磁盘映像格式，由 Microsoft 设计并在 Windows Vista 后的系统使用，用于支持它们的标准安装过程。自 Windows 8 系统以来，Microsoft 又推出了一种基于文件的高压缩比磁盘映像格式 —— ESD（Electronic Software Download），随后地映像文件大多采用 ESD 格式分发。</p><figure class="ss-imgRows" figcaption="Windows XP SP3 与 Windows 10 1909 映像"><img src="https://cdn.sspai.com//2020/08/11/66d047fcee3ee7585df3c5bbce6e2a0c.png" alt=""><img src="https://cdn.sspai.com//2020/08/11/668553d857058499b9e1b5b059ca2d9d.png" alt=""></figure><p>从 Windows XP 到 Windows 10，内核由 NT 5.x 升级为 NT 6.x，映像的内部结构发生了变化，相比于 NT 5.x，NT 6.x（Windows 8 后）采用了 ESD 映像，它能储存至多 8 个 WIM 映像文件，实现在单个映像中存储多个系统版本，举个栗子 —— 在安装系统的时候，安装程序会根据激活密钥选择对应版本，如家庭版、教育版、旗舰版、企业版、工作室版等。除此以外，还可单独提取映像中的 ​<code>source.wim​</code>，使用 CGI、Dism、ImageX 等工具进行安装，无需执行 Windows Setup 的流程，安装方式更加灵活。</p><p>系统封装后的映像还原方式与基于镜像的重装类似 —— 进入 PE 系统、使用映像还原工具将释放映像到系统盘、修复引导，不同的是，封装映像相比直接打包的映像多了 OOBE（Out-of-box experience）流程，用户需要填写相关信息方可进入系统。</p><h3>镜像备份与封装备份有什么不同</h3><p>从备份机制上来讲，镜像备份像是麦记的汉堡，我点了六个汉堡，生产线只会做六个给我，不会多也不会少，「点餐 - 取餐 - 开吃」，只要是选择范围内的文件，在打包时会完整地拷贝入镜像中；而封装备份好比是自助火锅，店家提供固定口味的汤底（系统），客人自选锅里的食材（驱动、系统设置、内置软件），吃完了还可以继续加，在封装系统时可以根据需要调整镜像的内容，封装完成后也可以继续修改。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/11/f802c7696758499e9837276959bc3556.gif"><figcaption>Ghost 备份：扇区到扇区（Sector to Sector）</figcaption></figure><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/11/c12b834a1a5031c2b5d66c9e0ff4fc37.gif"><figcaption>ESD/WIM 封装：文件到文件（File to File）</figcaption></figure><h2>工具介绍</h2><h3>Dism++</h3><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/a7243265d366426e1149f9f23c0ff7eb"><figcaption>Dism++</figcaption></figure><p><a href="https://www.chuyu.me/zh-Hans/index.html" target="_blank">Dism++</a> 基于比 Dism 更底层的 CBS（Component Based Servicing），为系统更新、系统修复、驱动管理、内置 / 可选功能管理、预装应用、服务管理等功能提供图形化操作，完整支持 WIM、ESD、ISO、具备相当开放的清理与优化功能。利用 Dism++ 中的系统备份功能，可为当前电脑生成备份映像。</p><p>自 Windows NT 6.x 起，系统的核心组件服务栈由 CBS（Component Based Servicing）、CMI（Component Management Infrastructure）、CSI（Component Servicing Infrastructure）、DMI（Driver Management and Install）、KTM（Kernel Transaction Manager）、SMI（Systems Management Infrastructure）六大部分组成。借助模块化的服务栈，每个系统组件需要的依赖被打包为小模组，各个模组之间相互独立，不受影响。针对不同架构的系统，使用 CBS 作为底层更具有优势 —— 无需考虑 Dism 在各个系统的兼容性（如 x86、x64、Arm 等），可脱离 Dism 依赖运行（即便是精简后的系统，也能够正常使用）。</p><h3>Easy Sysprep</h3><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/79d7fa0955e48ee16423ccb5161b6ca8"><figcaption>Easy Sysprep v5</figcaption></figure><p>Easy Sysprep 是 IT 天空出品的一款 Windows 操作系统封装部署辅助工具。它以微软系统准备工具 ​sysprep.exe​ 程序为核心，将复杂的 Windows 操作系统封装过程变得更加简单。除了直接将系统打包为映像，通过 Easy Sysprep，还可以进行一系列的优化、设置。</p><p>Sysprep 最初是为企业将系统映像部署到多台电脑中而设计，实现快速部署全新的生产环境。经过 Sysprep 初始化的电脑，除了映像内置的文件外，用户凭证、激活信息、外置设备、硬件驱动都会在封装映像时统一移除，方便后期还原至新的电脑中。</p><h2>前期准备</h2><p>实体机规格：</p><ul><li>主机：Intel NUC8i7HVK / Tigo 16G / SN550 512G</li><li>实体机系统：Windows 10 1809 (17763) LSTC Enterprise</li><li>虚拟机系统：Windows 10 2004 (19041) Professional</li></ul><p><strong>玩机有风险，设置需谨慎</strong>。以下内容需要一定的电脑操作知识（系统优化、重装等），为了避免错误操作导致的损失，请在操作前熟读教程与官方文档，并对重要资料进行多重备份。</p><p>镜像最重要的基础是系统，「基础不稳，地动山摇」，为了保证系统的完整性，务必使用纯净、未过度精简的系统镜像（如出厂系统盘、<a href="https://msdn.itellyou.cn/" target="_blank">MSDN iTellYou</a> 等）。</p><p>封装环境可以分为两种 —— 基于实体机、基于虚拟机，第一种方法适用于以下情况：1. 系统中的生产环境难以在虚拟机 / WTG 中复现，或有特定的硬件驱动、软件等；2. 软件什么的真的太多了，重新安装十分麻烦；3. 偷下懒。</p><h3>材料</h3><h4>1. 移动硬盘 / 云盘</h4><p>为了避免因为误操作导致文件丢失，务必对电脑中的重要文件进行<strong>多重备份</strong>（移动硬盘 + 云盘），备份、封装完成的映像同样需要转移至移动硬盘中；</p><h4>2. PE 维护 U 盘</h4><p>准备一个大小为 16G 或 16G 以上的闲置 U 盘，下载 <a href="http://wepe.cn/" target="_blank">微 PE</a> 或 <a href="https://www.itsk.com/idata/headerUrlRedirect.php?index=3" target="_blank">优启通</a> 等其它安全的 PE 维护系统，按照指引制作 PE 维护 U 盘；</p><h3>环境</h3><h4>1. 更新：让系统、软件保持在合适的版本</h4><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/220f45aec762ad9b5c3789ff3e139940"><figcaption>检查系统更新</figcaption></figure><p>系统更新：进入「系统设置 - 更新与安全 - Windows 系统更新」，为系统安装必要的更新。</p><figure class="ss-imgRows" figcaption="检查驱动更新"><img src="https://cdn.sspai.com//2020/08/11/ecc8cbebebe759abbdfaf3e859345401.png" alt=""><img src="https://cdn.sspai.com//2020/08/11/5c18eab5d3279498d4357471f4ff64ff.png" alt=""></figure><p>驱动更新：使用驱动工具检查显卡、芯片组、网卡、声卡驱动是否需要更新。</p><h4>2. 转移：移除私人文件、工作项目</h4><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/71115068ec147fb65438ce8f1b65249f"><figcaption>备份、移除重要文件</figcaption></figure><p>仔细搜寻「文档」、「桌面」、「新建文件夹」等位置是否有重要文件、工作项目，如果有，务必将其转移至移动硬盘、云盘或其它安全的位置，同时进行多重备份。部分软件在运行时会在个人文件夹中存放缓存文件、配置文件，如有需要，也请一并备份与移除，避免带入映像中。</p><h4>3. 清理：移除不需要的软件、垃圾</h4><figure class="ss-imgRows" figcaption="清理系统垃圾"><img src="https://cdn.sspai.com//2020/08/11/3ea4dc1c8bf901be15f246dad1408e17.png" alt=""><img src="https://cdn.sspai.com//2020/08/11/6ef3f4e624923552b40171363a17e526.png" alt=""></figure><p>使用 Dism++ 的空间回收功能、CleanMyPC 等工具，清理系统运行时产生的日志文件、软件缓存、历史记录，保持封装时不会带入到镜像中。</p><p>封装的镜像中不建议保留过多的软件，避免因镜像过大而占用过多的储存空间。只需留下硬件驱动、运行环境、常用工具、流媒体软件、工作/学习使用的软件，使用率较低的工具可以通过使用便携版（Portable Software）替代，Steam Library、移动到系统分区以外的分区中。</p><p>如果使用 Dism++ 进行备份，这一步可以通过设置 ExclusionList 排除部分文件和文件夹，缩短移动文件的时间。具体用法可参照下节。</p><h4>4. 优化：调整系统设置、软件设置</h4><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/11/7f3489f72ce67e5ab10e9735543eb7b7.png"><figcaption>优化方向</figcaption></figure><p>除了在控制面板调整系统偏好，我们可以使用 <a href="https://www.chuyu.me/zh-Hans/index.html" target="_blank">Dism++</a>、<a href="https://www.oo-software.com/en/shutup10" target="_blank">O&O ShutUp10</a>、<a href="https://mofang.ruanmei.com/" target="_blank">软媒设置助手</a> 等工具进行设置。有关系统优化的详细设置，可以根据个人喜好调整，也可以参照以下几篇文章：</p><ul><li><a href="https://sspai.com/post/43084" target="_blank">Eric_hong：这份 Windows 优化指南，帮你拯救越用越慢的老电脑</a></li><li><a href="https://sspai.com/post/42246" target="_blank">沨沄极客：Windows 系统不好用？让这些系统优化工具来调教它</a></li><li><a href="https://www.itsk.com/thread-404740-1-1.html" target="_blank">小鱼儿yr：ES5 封装教程 - 母盘安装及系统调整</a></li><li><a href="https://www.itsk.com/thread-404802-1-1.html" target="_blank">小鱼儿yr：ES5 封装教程 - 使用工具优化与清理</a></li></ul><h2>开始封装</h2><p>完成以上的准备工作后，下面我们可以开始打包映像，使用 Dism++ 备份类似以前的 Ghost 备份，打开、选择保存位置、运行，如果备份的映像是个人使用，推荐使用这种方法，简单、快速。Easy Sysprep 适用于映像需要向外分发的情况，如企业内部批量重装，封装工作相比前者麻烦许多，同时因为系统封装的特殊性，如果封装的系统版本为 Windows 7 以上，需要卸载所有从 Microsoft Store 下载的应用，并使用 Administrator 用户进行封装，其余用户需要全部删除，否则会出现 <a href="https://support.microsoft.com/zh-hk/help/2769827/sysprep-fails-after-you-remove-or-update-windows-store-apps-that-inclu" target="_blank"><code>0x3cf2</code></a> 错误。故下文封装部分是使用虚拟机进行封装。</p><h3>使用 Dism++ 一键打包</h3><p>首先在 <a href="https://www.chuyu.me/zh-Hans/index.html" target="_blank">初雨团队</a> 的官网下载 Dism++，下文使用的 Dism++ 版本为 10.1.1001.10，不同版本之间的操作方法大致相同。下载后，将压缩包中的文件解压至系统盘外的位置，如 <code>D:\Dism_Tool</code></p><p>根据系统版本，选择适合当前系统的版本，打开 Dism++，同意用户协议。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/b1bad59249d8dfbf4754183fad0a03e7"><figcaption>设置排除列表</figcaption></figure><p>如果有较多文件夹不便移动，可以将文件夹路径添加至排除列表中 (菜单栏 - 详细设置 - 排除列表设置)，如 iCloud File、Tencent Files、Wechat Files。关于 ExclusionList 的高级用法可参照 <a href="https://docs.microsoft.com/zh-cn/windows-hardware/manufacture/desktop/dism-configuration-list-and-wimscriptini-files-winnext" target="_blank">Microsoft - Dism Configuration</a>，此设置仅在 Dism 的映像备份中可用。</p><figure class="ss-imgRows" figcaption="Dism++ 映像备份"><img src="https://cdn.sspai.com//2020/08/11/f5745a2a9c8f019ea672a6dae361be96.png" alt=""><img src="https://cdn.sspai.com//2020/08/11/c5f92c145c65f9160445d617de937924.png" alt=""></figure><p>点击菜单栏中的「恢复功能 - 系统备份」，进入映像备份。</p><p>在文件保存对话框中，需要选择一个非系统盘的位置来保存备份映像；映像名称按照一定格式命名（<code>系统备份_日期_系统版本</code>），如「<code>D:\Sys_Backup\Sys_Full_Backup-200804-Win10.wim</code>」；压缩率按照需要选择，映像大小与制作所需时间、压缩率成反比，压缩率越高，制作所需的时间越长，映像文件越小，这里一般选择高压缩（Wim 格式映像）即可。</p><p>一切准备就绪后，我们便可以开始系统映像的打包。点击「保存」，映像开始备份。因为等待时间比较久，推荐在晚上临睡前开始备份。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/edbe8b884422e83ec2e42101cb44196b"><figcaption>备份完毕</figcaption></figure><p>备份结束后，在 D 盘的 Sys_Backup 文件夹中找到备份的映像文件，然后将其拷贝至移动硬盘等安全的位置，需要时能够快速调用。后期如果需要修改备份映像也十分简单，在保存路径中选择先前的备份映像，Dism++ 会自动执行增量备份。</p><h3>使用 Easy Sysprep 定制镜像</h3><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/4d211e659b6b76dd65c6f68d36b9d18c"><figcaption>执行步骤</figcaption></figure><p>与 Dism++ 的一把梭备份不同，系统封装会使母盘进入 OOBE 流程，同时，Sysprep 的准备阶段需要删除计算机中除 Administrator 以外的用户，并卸载所有来源于 Microsoft Store 的应用，因此封装的系统最好使用虚拟机或 WTG（Windows To Go）搭建，避免对工作环境产生影响。在对实体机系统进行全盘备份后，亦可直接进行封装（不推荐这种做法）。</p><p>虚拟机搭建有几个关键点需要留意：</p><ol><li>善用虚拟机的快照备份功能，每完成一阶段后拍摄一次快照，如系统安装完成、优化完成、第一阶段完成，以便执行错误操作后方便还原；</li><li>因进入 PE 的入口时间只有 3 秒，在初次启动时，需进入虚拟机的 BIOS 设置调整启动顺序（CD-Rom → HDD）；</li><li>系统安装时、完成后需要断网安装，<strong>请勿</strong>安装任何系统更新；</li><li>实体机与虚拟机的文件交换推荐通过 U 盘进行，无需安装伺主增强工具，如 VMWare-Tools、VBoxGuestAdditions 等；</li><li>完成第一阶段的封装后，正确的启动顺序是进入 PE 开始部署阶段，而非虚拟机系统；</li></ol><p>整个流程分为两大阶段，第一阶段检测系统、准备封装环境，为第二阶段奠定基础，如果出现错误提示，需要到 <code>C:\Windows\System32\Sysprep\Panther\setuperr.log</code> 找出错误代码进行排错。第二阶段为部署阶段，主要对母盘做出一定调整，以及设置部署时的执行任务，在 PE 系统中进行可以规避系统权限、文件占用的问题。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/11/914edd3e9404e16c94cacb0d9b2d3a33.gif"><figcaption>动图展示：第一阶段</figcaption></figure><figure class="ss-imgRows" figcaption="第一阶段"><img src="https://cdn.sspai.com//2020/08/11/3433f822bf70aff5055040db3e198912.png" alt=""><img src="https://cdn.sspai.com//2020/08/11/af981032b2b560269ea18c1db8aac90c.png" alt=""></figure><p>按照需求完成系统优化、安装后，进入封装的第一阶段。从 IT 天空论坛下载 <a href="https://www.itsk.com/forum.php?mod=viewthread&amp;tid=402133" target="_blank">Easy Sysprep v5</a>（本教程使用版本：5.19.802.282），下载完成后，解压到分区的根目录，如 <code style="font-style: inherit; font-variant-ligatures: inherit; font-variant-caps: inherit;">D:\Easy_Sysprep</code>。完成后打开 <code style="font-style: inherit; font-variant-ligatures: inherit; font-variant-caps: inherit;">EasySysprep.exe</code>。</p><p>点击「设置」，调整计算机名称、使用习惯、网络设置等，然后点击封装，完成后先对虚拟机拍摄快照，随后按照提示关机，调整虚拟机的启动选项，重新启动进入 PE 维护系统。注意，关机启动后务必进入 PE 系统，否则进入系统 OOBE 流程后需要从头开始。</p><p>进入 PE 系统，打开 ES5，进入部署阶段。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/11/009c53b0b9f11d624abff09788f85dd7.gif"><figcaption>动图展示：第二阶段</figcaption></figure><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/ab8b13512ccc4bf600c88e413b3f0713"><figcaption>关闭推广选项</figcaption></figure><p>进入后，在菜单中取消「网址导航」选项，点击主界面中「设置」，进入设置界面。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/bb1d911156d7ed1180b93c09720e347f"><figcaption>OEM 信息：设置主机信息、默认壁纸</figcaption></figure><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/ec9fed10bc65a386159aeb098e33ec6a"><figcaption>系统优化：调整应用设置</figcaption></figure><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/a29379a48bd68b4092467fe2dbe7a01c"><figcaption>部署设置</figcaption></figure><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/23d4b175120b1a396d2ab57a9e5feb66"><figcaption>系统设置</figcaption></figure><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/df5ff00b094a85322df7e534d341edbc"><figcaption>用户设置</figcaption></figure><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/11/article/58a59df551054ade2acead6c54a14782"><figcaption>网络设置</figcaption></figure><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/11/cd5eda0b2ff3c5e31338cf067c905262.png"><figcaption>部署时的任务计划</figcaption></figure><p>除了部署系统，在部署过程中通过自解压包的方式，可以注入万能驱动、内置程序等文件。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/11/a2817445bc40fdf8195b4a7315b05175.png"><figcaption>其它选项</figcaption></figure><p>来到最后一步，务必关闭左下角的「保存映像」，然后点击封装按钮，结束部署阶段。</p><figure class="ss-imgRows" figcaption="打包映像"><img src="https://cdn.sspai.com//2020/08/11/7677a1448dc93a251882b91393afadd3.png" alt=""><img src="https://cdn.sspai.com//2020/08/11/9926dfe74718a90f50bfe723dc9b2826.png" alt=""></figure><p>前期 ES5 对系统进行调整，接下来打开桌面的 EIX 系统安装，打包封装完成的映像，备份完后通过 U 盘等方式拷贝映像。此时，系统已被封装完成。最后一步，校验映像是否有效。重启虚拟机，系统进入 OOBE 流程，如无报错并正常进入系统，即表明映像无误。</p><p>也许会有网友好奇，最后一步同样是打包映像，搞那么多东西干蛤，食饱饭得闲冇嘢做？Dism 打包的方法简单、迅速，而且支持热备份，一次完整备份后还能增量备份，因此它更多的是面向个人的日常备份；Dism 打包的映像含有硬件驱动、用户信息、激活信息等，不适合分发用途，而 Easy Sysprep 侧重封装与分发，网上流行的「Windows 极限精简版、懒人安装版」正是系统封装的产物，面向多人、适用性广。</p><h2>还原映像</h2><figure class="ss-imgRows" figcaption="还原映像"><img src="https://cdn.sspai.com//2020/08/11/112be568dc632e99266780df2977390c.png" alt=""><img src="https://cdn.sspai.com//2020/08/11/da82060e1fbdad19eeaf4f2eda14ecf7.png" alt=""></figure><p>如果需要还原映像，除了可以通过先前制作的 PE 维护 U 盘进入维护系统还原，倘若先前在系统中整合了 Dism++ 的引导（选项 - 详细设置 - 勾选「整合至引导菜单」- 确定），在必要时可以进入 Dism++ on WinRE，选择对应选项操作即可。</p><p>还原映像的大致步骤如下：</p><ol><li>使用 Disk Genius / 傲梅分区助手 / 磁盘管理器格式化系统分区、引导分区；</li><li>打开 EIX 系统安装（优启通），左侧选择映像，右侧选择还原分区，点击「一键还原」；</li><li>重新启动进入系统，调整设置，还原完成；</li></ol><h2>尾言</h2><p>以上是定制映像的入门介绍，除了简单封装，你还可以使用 NLite 定制系统母盘、驱动包、优化注入工具、无值守部署等高级玩法，如有遗漏或错误之处，欢迎指正。通过 Dism++ 和 Easy Sysprep 定制系统映像，在 Bug 10 又出现新 Bug 后，我们可以更快地完成系统重装，恢复工作状态。</p><hr><h2>参考资料</h2><h3>解释</h3><ul><li><a href="https://zh.wikipedia.org/wiki/诺顿魅影系统" target="_blank">Wikipedia - 诺顿魅影精灵</a></li><li><a href="https://zh.wikipedia.org/wiki/磁盘映像" target="_blank">Wikipedia - 磁盘映像</a></li><li><a href="https://en.wikipedia.org/wiki/Windows_Preinstallation_Environment" target="_blank">Wikipedia - Windows Preinstallation Environment</a></li><li><a href="https://docs.microsoft.com/zh-cn/windows-hardware/manufacture/desktop/dism-configuration-list-and-wimscriptini-files-winnext" target="_blank">Microsoft - Dism Configuration</a></li><li><a href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/wim-vs-ffu-image-file-formats" target="_blank">Microsoft - WIM vs. VHD vs. FFU: comparing image file formats</a></li><li><a href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/sysprep--generalize--a-windows-installation#generalize-a-windows-installation" target="_blank">Microsoft - Sysprep (Generalize) a Windows installation</a></li><li><a href="https://support.microsoft.com/zh-hk/help/2769827/sysprep-fails-after-you-remove-or-update-windows-store-apps-that-inclu" target="_blank">Microsoft - Sysprep failed caused by Microsoft Store apps</a></li><li><a href="https://techcommunity.microsoft.com/t5/ask-the-performance-team/understanding-component-based-servicing/ba-p/373012" target="_blank">Microsoft - Understanding Component-Based Servicing</a></li><li><a href="https://www.smartdeploy.com/blog/the-difference-between-file-based-and-sector-based-imaging/" target="_blank">SmartDeploy - The difference between file-based and sector-based imaging</a></li><li><a href="https://blog.csdn.net/weixin_43272781/article/details/104642573" target="_blank">系统映像ISO、GHO、WIM、ESD的区别</a></li></ul><h3>工具</h3><ul><li><a href="https://www.chuyu.me/zh-Hans/index.html" target="_blank">Dism++</a></li><li><a href="https://www.oo-software.com/en/shutup10" target="_blank">O&amp;O ShutUp10</a></li><li><a href="https://www.itsk.com/thread-395023-1-1.html" target="_blank">Easy Sysprep v5 功能简介</a></li></ul><h3>教程</h3><ul><li><a href="https://www.itsk.com/thread-397145-1-1.html" target="_blank">Easy Sysprep V5 新版封装软件的图文封装教程</a></li><li><a href="https://www.itsk.com/thread-404410-1-1.html" target="_blank">小鱼儿yr - ES5 封装教程</a></li><li><a href="https://sspai.com/post/54281" target="_blank">2019 年，我们该如何重装 Windows 系统</a></li></ul><p>&gt; 下载少数派 <a href="https://sspai.com/page/client">客户端 </a>、关注 <a href="https://sspai.com/s/J71e">少数派公众号 </a>，了解更妙的数字生活 🍃</p><p>&gt; 想申请成为少数派作者？<a href="https://sspai.com/apply/writing" target="_blank">冲！</a></p>
➜想用 Notion 做任务管理？我们照着畅销书做了四个模板给你
https://sspai.com/post/61591	37804
<h3>Matrix 精选</h3><p><a href="https://sspai.com/matrix">Matrix</a> 是少数派的写作社区，我们主张分享真实的产品体验，有实用价值的经验与思考。我们会不定期挑选 Matrix 最优质的文章，展示来自用户的最真实的体验和观点。</p><p>文章代表作者个人观点，少数派仅对标题和排版略作修改。</p><hr><p>之前在 blog 上介绍 <i>Deep Work </i>等畅销书的时候，就有人问能不能把里面的工具做成模版，其实我们一点点在积攒，今天终于可以揭晓了：大家可以在<a href="https://www.notion.so/acacess/TMS-Templates-ed7fc7fe898f42019b1d875f41a488d7"> 这里</a> 找到所有的模版。</p><p>接下来我将对这些模板的结果和使用方法做一个简单的介绍。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/07/20/a6d259459ee3dd135687c658d38441be.png"><figcaption>Notion 生产力工具模版集合</figcaption></figure><h2>Make Time</h2><p>豆瓣链接：<a href="https://book.douban.com/subject/30327043/">Make Time</a>；《<a href="https://book.douban.com/subject/30419083/">创造时间</a>》</p><p><i>Make Time</i> 是一本讲述各种时间管理小技巧的书，作者曾经写过另一本畅销书 <i>Sprint</i>，也就是目前软件开发中常用的 Sprint 方法。书中有作者自己管理时间用的 Burner List，具体使用方法可以参考之前的文章： <a href="https://sspai.com/post/61456" target="_blank">用一张白纸就能完成的任务管理——用完就「烧」的 Burner List</a>。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/07/20/80e67899fbcc6972532a00608dc34f93.png"><figcaption>Burner List 模版</figcaption></figure><p><strong>模版地址：</strong><a href="https://www.notion.so/acacess/Burner-list-4aedf9ad873340158cc0161461d18c32" target="_blank">Burner List</a>；<a href="https://www.notion.so/acacess/Burner-list-for-Reflection-70d2f0e9f9654b94b1530ab0afa3a8b2" target="_blank">Burner List for Reflection</a></p><h2>Deep Work</h2><p>豆瓣链接：<a href="https://book.douban.com/subject/26649613/">Deep Work</a>；《<a href="https://book.douban.com/subject/27056409/">深度工作</a>》</p><p><i>Deep Work</i> 是畅销书作者 Cal Newport 介绍深度工作的一本册子。里面介绍了作者本人用来管理时间的方法。具体可以参见这篇文章：<a href="https://blogcn.acacess.com/you-ge-yong-zhang-zhi-ke-yi-wan-cheng-de-shi-jian-guan-li-ji-qiao-plan-actual-revised">时间管理技巧 001 -- 像 Deep Work 的作者一样管理时间 — Plan-Actual-Revised</a>。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/07/20/ab0b4fd6cba7806fb535e849667b6f99.png"><figcaption>Plan-Actual-Revised 模版</figcaption></figure><p><strong>模版地址：</strong><a href="https://www.notion.so/acacess/Plan-Actual-Revised-0c1877c08f52497d95c7a27006a26d5d" target="_blank">Plan-Actual-Revised</a></p><h2>Feeling Good</h2><p>豆瓣链接：<a href="https://book.douban.com/subject/1483914/">Feeling Good</a>；<a href="https://book.douban.com/subject/5980113/">伯恩斯新情绪疗法</a></p><p>严格来说，这是一本心理学着作，但里面也介绍了不少管理时间的方法。所以我们也把这些方法做成了表格。以下两个表格是用来克服拖延症的，一个叫 Daily Activity Schedule，一个叫 The Anti-procrastination Sheet。</p><p><strong>Daily Activity Schedule</strong></p><p>使用一张表格记录每天的所作所为 (Prospective)，然后在 Retrospective 一栏里标注 M (一些小的成就，比如刷牙吃饭)，或者 P (一些乐趣，比如看书看展)。</p><p>Dr. Burns 建议把每小时的所作所为都计划下来，然后进行评估。即使做不完每一项也没关系，至少我们可以看到自己做了什么，总比完全拖着好。这个表格对于「不知道周末做什么」可能会很有用，每周五晚上，可以拿出这张表格来规划周末做什么。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/07/20/d0bb2292f16f5c739d1beedc09ce5cef.png"><figcaption>Daily Activity Schedule 模版</figcaption></figure><p><strong>The Anti-procrastination Sheet</strong></p><p>Dr. Burns 介绍的第二种应对方式是记录自己觉得困难的任务，并给予打分。</p><p>首先需要将一个困难的任务拆解成子任务。然后评估每一个子任务的困难度和满意度，待完成后再对实际困难度和满意度打分。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/07/20/5e89ffa35b2e36d02fa8fa1beb0787bc.png"><figcaption>The Anti-procrastination Sheet 模版</figcaption></figure><p><strong>模版地址</strong></p><p><a href="https://www.notion.so/acacess/Daily-Activity-Schedule-Easy-mode-85f6aeeef9e543969afe8b4e9fe7db5e" target="_blank">Daily Activity Schedule (Easy mode)</a>；<a href="https://www.notion.so/acacess/Daily-Activity-Schedule-508f42e1858c46a192caf1d3aff1ac23" target="_blank">Daily Activity Schedule</a></p><p><a href="https://www.notion.so/acacess/430764562efc4a2d9674b9a7f05f0bc6?v=c859378485bf465b9bce4a04a2260dc3" target="_blank">The Anti-procrastination Sheet</a>；<a href="https://www.notion.so/acacess/6c362a9de7954900bfcdb910fb2434d9?v=de520892f9ae42ed8b860c4576e644bb" target="_blank">The Pleasure-Predicting Sheet</a></p><h2>Recap</h2><p>以上是几本书生产力书籍里的工具模版，我们也慢慢积累其他的工具模版。</p><p>如果你有什么建议，欢迎告诉我们。</p><p>如果你想获得更及时的更新，可以加入我们的 TG 群：<a href="https://t.me/tms_discuss" target="_blank">https://t.me/tms_discuss</a>，或者订阅我们的 TG 频道：<a href="https://t.me/tms_ur_way%20" target="_blank">https://t.me/tms_ur_way</a></p><p>&gt; 下载少数派 <a href="https://sspai.com/page/client">客户端 </a>、关注 <a href="https://sspai.com/s/J71e">少数派公众号 </a>，了解更妙的数字生活 🍃</p><p>&gt; 想申请成为少数派作者？<a href="https://sspai.com/apply/writing" target="_blank">冲！</a></p>