➜如何看待三国题材的手机游戏《鸿图之下》?
http://www.zhihu.com/question/404727259/answer/1535128164?utm_campaign=rss&utm_medium=rss&utm_source=rss&utm_content=title	14530
<p>感谢 <a class="member_mention" href="//www.zhihu.com/people/70c5673ee4e9644003f7a725c4a06a4e" data-hash="70c5673ee4e9644003f7a725c4a06a4e" data-hovercard="p$b$70c5673ee4e9644003f7a725c4a06a4e">@知乎游戏</a> 邀请。</p><p>大家好，我是《鸿图之下》的引擎工程师，从《鸿图之下》立项到即将上线的三年的时间里，主要负责引擎架构及渲染模块，有过迷茫有过困惑但从未放弃，终于这款SLG手游要与大家见面了，在这里非常感谢大家对《鸿图之下》的关注及支持。</p><p>从刚刚接手任务，世界还一片混沌，除了登录界面什么都没有的状态，到现在我们拥有了一套自己的SLG地形系统、一套实时演算的战斗系统，内心里说实话还是十分高兴的。</p><p>最开始项目组给我们的引擎需求非常简单明了：<b>“一个400万地格的大世界，能满足美术方便编辑和生成地形”</b>。一般像这种越是简单的需求，做起来就越是复杂，可能策划心里面也没想好要做成什么样子。不过这也方便我们自由发挥，想怎么改就怎么改。美术同学只好在心里吐槽，地形好多参数，怎么改了一个值整个地形都不一样了？河流那么复杂，我只想调整一下河流的朝向都这么困难吗？</p><p><b>有意思的是，我们是先有了战斗系统，然后才有的沙盘大世界。</b>负责战斗系统的客户端主程序对于最后游戏的效果其实并不百分百满意，按照系统一开始的设计，是可以满足玩家在战局内完全自由操作军团和武将的，然而由于玩家学习成本太大，且对手游玩家不够友好，出于完善用户体验的目的，这些功能最后被策划做了精简，这个遗憾可能只能等到后续新的项目弥补了。</p><p>回归正题，说到SLG手游，相信不少玩家脑海中第一时间构想出来的可能是2D画面、略显粗糙的人物头像和地图贴图？</p><p>的确，在现在的手游市场，SLG这个品类的整体画面品质确实不尽如人意：2D画面、穿模人物、贴图效果比比皆是，反观其他类型的游戏，像MMO、MOBA，在画面上一个赛一个精致、一个比一个更有沉浸感。对三国爱好者来说，一款高画面品质的三国策略游戏，可能是一个刚需，这也是我们团队历时3年坚持打造《鸿图之下》的初衷。</p><p><img src="https://pic1.zhimg.com/v2-3a5d6e2cd19ff0c0075ee16c1f63f9fe_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1206" data-rawheight="679" data-watermark="watermark" data-original-src="v2-3a5d6e2cd19ff0c0075ee16c1f63f9fe" data-watermark-src="v2-ddf150e3e80169009d723d4ad09e44ff" data-private-watermark-src="v2-fb2b9bc6fc170742ebed153c2ec7429e" style="max-width: 400px;"></p><p><b>我们为何有自信说《鸿图之下》是一款高品质的SLG游戏？</b></p><p><b>因为，《鸿图之下》是腾讯首款以UE4（虚幻引擎4）打造的策略手游，得益于UE4的强大画面表现力和工具集，我们得以塑造出一个全3D的宏大三国世界。</b></p><p>先来看一个简短的小视频，纵观一下UE4加持下的《鸿图之下》到底长什么样子。</p><a href="https://www.zhihu.com/zvideo/1302198734428413952">鸿图之下-介绍视频</a><h2><b><i>一．为什么选择虚幻引擎4（UE4）？</i></b></h2><p>游戏引擎是任何一款游戏的立身之本，而游戏引擎也决定了游戏最终的呈现品质。</p><p>不清楚什么是UE4的话，可以看看维基百科的相关介绍，这里我就不赘述了：</p><a href="//link.zhihu.com/?target=https%3A//baike.baidu.com/item/%25E8%2599%259A%25E5%25B9%25BB4%25E5%25BC%2595%25E6%2593%258E" data-draft-node="block" data-draft-type="link-card" data-image="https://pic1.zhimg.com/v2-a64774de231eee7f3449f6649c9cdaef_bh.jpg" data-image-width="320" data-image-height="105" class=" wrap external" target="_blank" rel="nofollow noreferrer">虚幻4引擎_百度百科</a><p>其实当下UE4引擎更多的是被用于3A单机游戏的开发，比较典型的例子就是前段时间爆火的国产单机游戏《黑神话：悟空》。我们想要打造出一款最真实的三国游戏，让一刀一枪，一草一木皆肉眼可见，还原古三国战场的贴身肉搏，让玩家身临其境真正体会冷兵器时代的战争逻辑，无疑UE4是最好的选择。</p><p>从技术的层面，UE4开放源码的优势能让我们更加方便修改渲染管线，以及地形编辑的工具集。虽然在制作过程中也遇到了一些难以攻克的问题，也出现过相同功能的推倒重做，但就整体而言，开源的优势极大地提高了我们工作的效率，我们得以深挖引擎内部的实现，在效果和效率上都做到了移动端我们能做到的极致。</p><p><b>正因为UE4强大的画面表现能力以及工具集来开发《鸿图之下》，我们可以给热爱战略游戏的玩家提供一个充分利用天时、地利、人和的作战机会，实现“身临其境的真实三国战场”。</b></p><p><img src="https://pic1.zhimg.com/v2-9ca52e11be0c96c0d2a402a6831231f5_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1154" data-rawheight="645" data-watermark="watermark" data-original-src="v2-9ca52e11be0c96c0d2a402a6831231f5" data-watermark-src="v2-04ef132535c03cfa2eedaecbdcb4dc41" data-private-watermark-src="v2-33e7c1ee753e3286244a84447d5387ea" style="max-width: 400px;"></p><h2><b><i>二．我们如何借助UE4去还原一个真实的三国战场？</i></b></h2><p>任何一场战争的胜败，仅凭单一的因素是无法决定的，天时地利人和一个都不能少。</p><p>【正是因为有了东风，诸葛亮才能火烧赤壁】</p><p>【正是因为在寒冬季节，曹操才能夜建冰城抵马超】</p><p>在《鸿图之下》中，我们借助UE4，通过<b>天时、地利、人和三个维度</b>对真实三国战场进行了全方位的还原：</p><p><b>1）天时 —— 借助UE4实现了天气、昼夜、四季的变换</b></p><p>通过UE4提供的全局光照烘焙，我们打造了实时光影来实现昼夜的变化，借助自然风场、四季和天气模拟技术，打造了一个高度拟真的天气系统，给玩家超强的视觉展示。</p><p><img src="https://pic1.zhimg.com/v2-c287e0eb05b242ac97a2ba8a4bcec06d_720w.gif?rss" data-caption="" data-size="normal" data-rawwidth="400" data-rawheight="226" data-watermark="watermark" data-original-src="v2-c287e0eb05b242ac97a2ba8a4bcec06d" data-watermark-src="" data-private-watermark-src="" style="max-width: 400px;"></p><p>这里的拟真不单单是指画面效果的高度还原，更是直接把“天时”和战术直接做了挂钩。昼夜、天气等都将影响玩家单局的作战策略，利用拟真的物理规则向战略家发出更高难度的策略挑战。</p><p><img src="https://pic1.zhimg.com/v2-3dca59d4ceddc04f58497eb23b3d36b3_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1077" data-rawheight="308" data-watermark="watermark" data-original-src="v2-3dca59d4ceddc04f58497eb23b3d36b3" data-watermark-src="v2-2b0a902361d3f387ab70ea33292b01e0" data-private-watermark-src="v2-f5848ee326edf945d83a86018850e5ff" style="max-width: 400px;"></p><p><b>2）地利 —— 借助UE4构造了400万地格超大世界</b></p><p>UE4在构建大世界上其实是有独特优势的，我们在《鸿图之下》中构建了400万地格超大世界，换算成现实相当于400万平方公里，并且针对SLG类游戏的特点，我们还在UE4的基础上拓展了地形渲染引擎和编辑器，融合不受限制的地形贴图数量，在400万地格的基础上设计了达20多种地形，为玩家模拟还原三国真实地形地貌。</p><p><img src="https://pic1.zhimg.com/v2-9445f1ef1d1d064e2ec2c71935232948_720w.jpg?rss" data-caption="（雪山）" data-size="normal" data-rawwidth="564" data-rawheight="317" data-watermark="watermark" data-original-src="v2-9445f1ef1d1d064e2ec2c71935232948" data-watermark-src="v2-95ebb9908826bbfb69053ab6e9e7cddd" data-private-watermark-src="v2-74df6c79b7082d494ac89560dabce754" style="max-width: 400px;"></p><p><img src="https://pic1.zhimg.com/v2-0b2840f1b2e51f96e6b19b676de69206_720w.jpg?rss" data-caption="（沙漠）" data-size="normal" data-rawwidth="560" data-rawheight="315" data-watermark="watermark" data-original-src="v2-0b2840f1b2e51f96e6b19b676de69206" data-watermark-src="v2-25a2cb46eae68d831d996a146a557258" data-private-watermark-src="v2-fb517fb60b6f7fdca6ac342ff9c4dff8" style="max-width: 400px;"></p><p><img src="https://pic1.zhimg.com/v2-2c0727e46f67499c06435bb2d5ad7655_720w.jpg?rss" data-caption="（草地）" data-size="normal" data-rawwidth="567" data-rawheight="318" data-watermark="watermark" data-original-src="v2-2c0727e46f67499c06435bb2d5ad7655" data-watermark-src="v2-47b3e9112a041cca1e9f599a185b0716" data-private-watermark-src="v2-24a504ad52defa73d6539e666120bad0" style="max-width: 400px;"></p><p><img src="https://pic1.zhimg.com/v2-adb8df486619c36a3cd2ec9ed00ff28d_720w.jpg?rss" data-caption="（雪原）" data-size="normal" data-rawwidth="564" data-rawheight="315" data-watermark="watermark" data-original-src="v2-adb8df486619c36a3cd2ec9ed00ff28d" data-watermark-src="v2-9390771583177ca4e908250b43f3fa38" data-private-watermark-src="v2-ab38c30b2b63435fb37ee7c2d9ec664b" style="max-width: 400px;"></p><p>在地形的实现上，我们尝试过很多种方案，一开始尝试过用高度图制作山的方案，但是无法解决山地阴影过于粗糙的问题，呈现出来的效果会偏向卡通风格。直到最后我们才决定用山的模型和地表渲染的方式去处理，这样可以确保山的模型法线足够精致，也利于美术同学控制山的表现。</p><p>实际上在地形的制作过程中，美术同学持续的支持和沟通起到了很关键的作用，每当地形渲染迭代一个功能的时候，他们都需要重新学习一遍，有的时候隔几天就会迭代一个小功能，迭代的过程中他们还得充当QA的角色，测试编辑器的稳定性。更经常出现的情况是，新的地形编辑器编译好了，美术同学忘了更新，还是处理旧的地形数据，结果一旦更新svn就发现以前的数据用不了了，陷入了抓狂的状态……在这里要隆重地向我们美术同学致以崇高的敬意！</p><p>最终，通过UE4提供的PBR渲染，我们将不同地形的元素，像城池、木材、石块的纹理，以及水流等材质进行写实的呈现，并配合实际的声效，在完成了宏大的世界之后，用细节去填充这个三国世界。</p><p><img src="https://pic1.zhimg.com/v2-3f04d7a032894af70d3d0dfa6fcb0195_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1154" data-rawheight="533" data-watermark="watermark" data-original-src="v2-3f04d7a032894af70d3d0dfa6fcb0195" data-watermark-src="v2-55f62307f8dcdb11c20b37c91cde39c3" data-private-watermark-src="v2-ee3120866efca180061bd03e4ec5f0f6" style="max-width: 400px;"></p><p>在《鸿图之下》中，还拥有无极地图缩放，玩家可通过双指放大缩小地图，进入到不同的场景之中，这样的全新视角，不仅能帮助玩家纵观世界格局，更能探察城池方圆的风吹草动。为了实现顺畅的缩放操作，引擎端做了很多渲染的优化。确保从3D地图切换到2D地图的时候，不会有太大的帧率变化。</p><p><img src="https://pic1.zhimg.com/v2-7efeaf1008231377c90d802f36ff7dbf_720w.gif?rss" data-caption="" data-size="normal" data-rawwidth="400" data-rawheight="226" data-watermark="watermark" data-original-src="v2-7efeaf1008231377c90d802f36ff7dbf" data-watermark-src="" data-private-watermark-src="" style="max-width: 400px;"></p><p><img src="https://pic1.zhimg.com/v2-61e7720cd84b6f9fa3bf221a882c448c_720w.jpg?rss" data-caption="（世界格局）" data-size="normal" data-rawwidth="1154" data-rawheight="519" data-watermark="watermark" data-original-src="v2-61e7720cd84b6f9fa3bf221a882c448c" data-watermark-src="v2-a5a1f674892e415cf8d1a398cc5927cb" data-private-watermark-src="v2-1b7ad3fb23d3f5c325c734d66b79d5df" style="max-width: 400px;"></p><p><img src="https://pic1.zhimg.com/v2-661aa8a9713b7720895ba68332857f38_720w.jpg?rss" data-caption="（城池周围）" data-size="normal" data-rawwidth="1154" data-rawheight="519" data-watermark="watermark" data-original-src="v2-661aa8a9713b7720895ba68332857f38" data-watermark-src="v2-32c13ea064c2ab37aed5bd4f64e3bf2e" data-private-watermark-src="v2-160ba869bb9eefff36333bf7526c92bc" style="max-width: 400px;"></p><p><b>3）人和 —— 借助UE4真正展示出千人同屏征战的壮阔景象</b></p><p>在UE4的支持下，我们在移动端突破地实现了1000V1000的千人同屏大作战。</p><p><img src="https://pic1.zhimg.com/v2-04e8a6bc01f5033d9b574ad20fc2d51f_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1154" data-rawheight="533" data-watermark="watermark" data-original-src="v2-04e8a6bc01f5033d9b574ad20fc2d51f" data-watermark-src="v2-72ea2d3c0f2e170978962ea27f9e9540" data-private-watermark-src="v2-47d7efbc0912beee7c8a15e861b3ddb0" style="max-width: 400px;"></p><p><img src="https://pic1.zhimg.com/v2-66e0282c78b950900aca9cc750a8cf5f_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1154" data-rawheight="533" data-watermark="watermark" data-original-src="v2-66e0282c78b950900aca9cc750a8cf5f" data-watermark-src="v2-c65d8a88b464fcbabc9403701c8a6bab" data-private-watermark-src="v2-deb36e9853a563ea08fa440d9f2e0000" style="max-width: 400px;"></p><p>通过GPU骨骼蒙皮动画，确保了在手机上也能呈现出非常宏大且优质的团队士兵作战，剑雨、落石、火球等炫酷的战斗特效。</p><p><img src="https://pic1.zhimg.com/v2-fe37dbf72365468d6d67c6093fbb036b_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1154" data-rawheight="520" data-watermark="watermark" data-original-src="v2-fe37dbf72365468d6d67c6093fbb036b" data-watermark-src="v2-247f3bf4ec27b3482a8dd34f1db27027" data-private-watermark-src="v2-054e3d7e4242e1c3b381f5e2cbd01d1f" style="max-width: 400px;"></p><p><img src="https://pic1.zhimg.com/v2-1fde58d184f6aed4773ba04d833d6945_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1154" data-rawheight="504" data-watermark="watermark" data-original-src="v2-1fde58d184f6aed4773ba04d833d6945" data-watermark-src="v2-446fec621ae656d427c2f69dcda75b0c" data-private-watermark-src="v2-f0ee78b4879b3f7686b2087abc165216" style="max-width: 400px;"></p><p><img src="https://pic1.zhimg.com/v2-91703322ca1f05dea88d7aebb758bfe2_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1154" data-rawheight="597" data-watermark="watermark" data-original-src="v2-91703322ca1f05dea88d7aebb758bfe2" data-watermark-src="v2-9f4caab5e4606f893c5f91a79216a02a" data-private-watermark-src="v2-9b8951e9f7572a0ce8c61dc314d5ad60" style="max-width: 400px;"></p><p>为了解决《鸿图之下》大量模型在战斗时可能会出现的模型穿插或者动作一致的问题，我们通过算法，利用移动端的硬件，多线程和多核的优势，并行高效的计算精准到了每个士兵的碰撞和动作，兵卒、甲胄、立盾、刺枪细节可察，为玩家呈现千万兵卒战场的真实物理碰撞、精细的士兵动作，让玩家不仅是个看战报的局外人，而是能够亲身参与到整场战役。</p><p>在优化性能的时候，美术同学一开始并不愿意把士兵的模型面数降的太低，认为那样会让效果显得太糙。但实际上，除了离摄像机特别近的模型，远一点的模型基本都处于“看个样子”的状态，加起来都可能不到100个像素。在我们的不断坚持下，原有的LOD模型都往对半砍甚至是四分之一的数量砍。HLOD的计算我们也进行了优化，避免大量模型的时候HLOD分组里包含距离过远的元素。最终，在保证低端机上也能跑到足够高的帧率的基础上，能够让高端机镜头拉近的时候也能看见非常清晰的武将和士兵细节。</p><p><img src="https://pic1.zhimg.com/v2-1318a56d9813ba47be44cfb84b0f57fb_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="2688" data-rawheight="1242" data-watermark="watermark" data-original-src="v2-1318a56d9813ba47be44cfb84b0f57fb" data-watermark-src="v2-4770c1c320dda2f026b75695c81bd1d1" data-private-watermark-src="v2-813caae8a29276c6c07b853419fea5a0" style="max-width: 400px;"></p><p>为了把综合战斗表现力更好的带给大家，我们在战役模式中采用了即时战斗，不像传统SLG或者回合制卡牌类游戏那样的回合制战斗，而是操作都能得到即时的反馈，两军真实的在交锋，这样可以更好地还原策略玩家对于战场的理解和代入感。</p><p><img src="https://pic1.zhimg.com/v2-7e4a836c3694b916ea2ec8b194ca6a91_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1154" data-rawheight="504" data-watermark="watermark" data-original-src="v2-7e4a836c3694b916ea2ec8b194ca6a91" data-watermark-src="v2-56f266a7a6de91f38c6330a675c4e888" data-private-watermark-src="v2-126eef995ab696cb371e22f2a7865de7" style="max-width: 400px;"></p><p>同时，在战争中常见的两支部队对冲的形式，在这个战斗场景下就存在接触先后的问题，是两侧先接触还是中间先接触，技能的释放又是对着谁的？为了解决这个问题我们加入了一个阵形的设计，带有尖头的队伍阵形，那么就是尖的地方是先接触敌人的，并且有不同的接触面积，导致最终的算法和战斗结果都不同。这样整个游戏，就会呈现一种非常多样的战斗体验。</p><p><img src="https://pic1.zhimg.com/v2-ed208eb6347a88c6f2d345c005d2d102_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1154" data-rawheight="507" data-watermark="watermark" data-original-src="v2-ed208eb6347a88c6f2d345c005d2d102" data-watermark-src="v2-7fe2619a1e269cd59bb6753ba8015cc6" data-private-watermark-src="v2-658ab7083289d875c42630609195e425" style="max-width: 400px;"></p><p><img src="https://pic1.zhimg.com/v2-6208c0b171e4fb46f4eb99f5713f2ac1_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1154" data-rawheight="503" data-watermark="watermark" data-original-src="v2-6208c0b171e4fb46f4eb99f5713f2ac1" data-watermark-src="v2-b5eb64cebed4839df1fa9027d77aa71b" data-private-watermark-src="v2-aeecf955ce3e9f97596fb0cbc53121c7" style="max-width: 400px;"></p><p>我们觉得做游戏，第一要义就是让玩家们觉得好玩、有意思，愿意花时间沉浸其中，换句话说就是让玩家得到更好的游戏体验，希望我们借助虚幻引擎4的运用打造出的全3D真实三国战场，在画面、战斗体验、策略性上，都能给各位热爱三国、热爱SLG的玩家带来更好的体验升级。希望大家能够下载体验并喜欢《鸿图之下》。</p><p>谢谢！</p>