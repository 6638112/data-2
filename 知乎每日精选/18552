➜想要自己做一款游戏，需要学习哪些知识？
http://www.zhihu.com/question/21031559/answer/1515921064?utm_campaign=rss&utm_medium=rss&utm_source=rss&utm_content=title	10820
<a href="https://www.zhihu.com/zvideo/1256888064590438400">自制网游星际逮虾户4人对战视频</a><p>本来想花几个月好好做一个能看的二刺螈软萌风搓狐狸的游戏再来逼乎吹一吹，奈何最近忙着炼丹没时间捣鼓，上面这个是一个多人在线网游，虽然只是个用于测试引擎的美术两小时搞完的demo版本，但麻雀虽小五脏俱全，目前已经在github完整开源，过段时间不咕的话会移植到Android端。</p><p>这款游戏的实现相当相当底层</p><p>1-首先语言选定为c语言，完成一个内存池，实现内存的分配释放，这里主要问题是内存的分配和释放效率问题和减少内存碎片，实现基础的数学函数例如sin cos sqrt log等，这里涉及一些数学知识 不过总体并不算太复杂。</p><a href="https://zhuanlan.zhihu.com/p/72355374" data-draft-node="block" data-draft-type="link-card" class="internal">DBinary：PainterEngine 内存池实现与细节</a><p>2-现在代码完全独立于平台，不依赖任何三分库和标准库，在此基础上完成颜色，向量和矩阵的一系列封装，然后完成基础数据结构string，list，vector，map，queue这里可以参考标准库的实现例如map可以采用红黑树，总体而言不算太复杂，大部分是体力活。</p><p>3-完成一些常用的算法,例如信号处理相关的dft fft dwt 各类window及filter，密码相关的AES Curve25519 sha256 ，四叉树，kd树，声音混音器...不是所有都用的上，有些可以直接上手开干，有些理论较为深奥例如密码学那块的，可以上github上找ms，Google，apple一些大厂的开源代码改改移植过来</p><p>4-完成编写渲染器前的一些基本工作，例如定义颜色格式，封装render surface，texture，vertex等数据结构，现在可以开始实现软渲染器了，可以先从一些简单的几何图形光栅化开始，线，矩形，圆，扇形，三角形，如果不做反走样的光栅化都挺简单的，但如果是考虑渲染效率的反走样光栅化，就完全不是一个难度了，同时完成一些基础常用图形格式的解析例如bmp位图，自己创建了一种带透明通道的图片格式traw，由png转换得到。</p><p>5-完成透视投影变换，纹理映射引出VS及PS接口，完成一个3d软渲染器，需要一些图形学的基础，但这部分听上去高大上，完成起来并没用想象中那么复杂，因为不是主要用途，所以在实现一些简易动画上基本凑活够用了。</p><p>6-开始设计一门编译型脚本语言，构思其基本语法，实现词法和语法分析，然后开发编译器，虚拟机(带调试器)，需要一些编译原理的基础，但真正用到的知识点并不多，主要是ast树的构建，可以采用递归下降分析法，可以设计为定长指令，这样虚拟机部分做起来难度小得多，一些核心算法完成后，主要还是堆语法糖之类的苦力活。</p><a href="https://zhuanlan.zhihu.com/p/72356928" data-draft-node="block" data-draft-type="link-card" class="internal">DBinary：从虚拟机架构到编译器实现</a><p><br></p><p>7-现在可以开始设计游戏引擎了，一个对象管理器方面的内容，一个游戏对象基本可以用initialize update render三部分组成，另外最大的难点应该是一个较为通用的碰撞检测实现，另外就是对象的创建，销毁，回收 这部分与脚本引擎对接，引出接口便于游戏拓展。</p><p>8-在上面的基础上,完成资源管理器,包括纹理,音频,脚本资源,文本资源...进一步设计动画管理器,粒子系统,音频管理器,编写tools以编辑资源</p><p>9-设计网络同步协议(帧同步),主要是处理延迟平滑,断线重连等问题</p><p>10-依据以上游戏引擎,绘制游戏的图片资源,设计游戏Object的逻辑处理代码,加载资源,并编写单机DEMO</p><a href="https://zhuanlan.zhihu.com/p/72367056" data-draft-node="block" data-draft-type="link-card" class="internal">DBinary：PainterEngine打造独立游戏</a><p>11-编写游戏服务器,包括游戏大厅客户端,游戏大厅服务端,游戏实例客户端,游戏实例服务端,建立数据库管理系统,使用Curve25519+AES建立数据的安全连接.</p><p>12-编写平台兼容层代码,渲染renderbuffer并播放混音合成的PCM音频流,最后测试游戏,发布</p><p>开源地址:</p><a href="//link.zhihu.com/?target=https%3A//github.com/matrixcascade/PainterEngine-Game" data-draft-node="block" data-draft-type="link-card" data-image="https://pic1.zhimg.com/v2-bb0e8038bad7f0f3f021f9a6d465814a_l.jpg" data-image-width="196" data-image-height="196" class=" wrap external" target="_blank" rel="nofollow noreferrer">matrixcascade/PainterEngine-Game</a><p>游戏的网站服务端:</p><a href="//link.zhihu.com/?target=https%3A//pan.baidu.com/s/1h5aBmCfizWNj7FTSv4cJ7A" data-draft-node="block" data-draft-type="link-card" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">pan.baidu.com/s/1h5aBmC</span><span class="invisible">fizWNj7FTSv4cJ7A</span><span class="ellipsis"></span></a><p>提取码:ue5w</p><p><br></p><p><img src="https://pic1.zhimg.com/v2-38d446c380ac5f6e39c0ddc3edb0c8fc_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="225" data-rawheight="260" data-watermark="watermark" data-original-src="v2-38d446c380ac5f6e39c0ddc3edb0c8fc" data-watermark-src="v2-e5fe70243559ef96ada5b72b77025bd6" data-private-watermark-src="v2-90f340607baea1c0a482865685a802a3" style="max-width: 400px;"></p>
➜如何评价《天涯明月刀》手游？
http://www.zhihu.com/question/288181000/answer/1527515537?utm_campaign=rss&utm_medium=rss&utm_source=rss&utm_content=title	14411
<p></p><p><img src="https://pic1.zhimg.com/v2-afd918630e8c626f58964d29ac6bcb1f_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="573" data-rawheight="467" data-watermark="watermark" data-original-src="v2-afd918630e8c626f58964d29ac6bcb1f" data-watermark-src="v2-9fd88a51b046a3e7389d24b637a59e73" data-private-watermark-src="v2-6d3317e40a723673bf8c10aa3a338670" style="max-width: 400px;"></p><p>先自我介绍下哈：程序员一枚，任职腾讯北极光工作室群引擎组技术总监，从天刀端游立项的2010年开始做天刀；</p><p>在天刀端游阶段是引擎架构师，主要负责渲染模块；天刀手游引擎模块直接负责人是团队里的老刘，我这里研发期做大的技术选型上的把控推进（中间在做《无限法则》，只能打嘴炮），实操写代码集中于天刀手游的研发前期和后期；</p><p>第一天开服上线，如临大敌，果然还是出了些程序问题，汗颜；</p><p>总算主要问题做了fix，心里稍安，回想过去的10年，真是各种感慨。</p><p>所以想在这个问题下，聊聊过去的十年，聊聊技术，聊聊团队；</p><hr><p><i>“感恩节临近了，他们在湖畔小屋里的工作也进入了白热状态，那是真正的废寝忘食：睡觉已经不算是件事情，洗澡也一样，只有吃饭</i></p><p><i>是不能省略的，他们要不时地提醒自己。”</i></p><p><i>“在那湖畔的小屋里，没有什么事情看上去是不可能的。”</i></p><p>（《doom启世录》，第四章）</p><p>当年就是看了缔造了quake和doom的卡马克和IdSoftWare的传记《doom启世录》入的游戏开发这行；</p><p>虽然不敢奢望如IdSoftWare一般的炸裂，但确实非常向往这种废寝忘食，创造不可能的感觉；</p><p>14年底，天刀端游结束了最后一次测试，即将在15年中上线；</p><p>这时候天刀端游在表现品质和性能上都有很不错的表现，制作人唯一的要求就是能稳定上线就好了；</p><p>当时我们能在普通电脑上流畅跑出100多人团战，同期竞品大约是20-30人；</p><p>但我和老刘认为团战可以到200人，于是那个春节在和家人商量之后，我们都留在了公司，希望能把这个实现出来；</p><p>随着春节临近，办公室开始空荡荡起来，美术，策划，pm，需求，计划。。。所有的干扰都消失了；</p><p>办公室里只有键盘的敲击声和技术的讨论（嗯嗯，时不时也有争论）。</p><p>经过几年的合作，我们编程配合非常好了，这个阶段我们在程序侧的“全局优化”已经很颇得心应手了；</p><p>“全局优化”这个就是指单个程序员能从最上层的逻辑到底层的算法，到汇编级的表现，到硬件里的运行状态都有不错的掌控力，进而产生的一系列的系统到算法级的调整，疗效颇好；</p><p><img src="https://pic1.zhimg.com/v2-32a736d90f92c51d80000bbb5b29342e_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="923" data-rawheight="519" data-watermark="watermark" data-original-src="v2-32a736d90f92c51d80000bbb5b29342e" data-watermark-src="v2-e3102bbea47db84b5cab0cf8b98bbd29" data-private-watermark-src="v2-b3b013b49a474b72ee0bdfa70a2a922c" style="max-width: 400px;"></p><p>（天刀端游的团战截图）</p><p>这种纯粹无干扰的技术开发，各种思维的碰撞真的很享受，结果也如我们预期：春节后，大家回来，我们则拿出了一个能流畅运行超过250人团战的版本，策划看了说“我密集恐惧症快犯了”。。</p><hr><p>时间来到2020年，在天刀手游对外测试的总结会上，制作人猫叔和运营同事都提出了多人体验问题，不够流畅，卡顿等等。</p><p>于是再次祭出“全局优化”的招数，经过过去几年的沉淀，我们的全局优化可以进一步做到团队级别了，也就是从产品的角度来看问题，从策划，到美术，到技能设计，特效制作，角色制作，再到程序的高层，服务器，中层，底层，到硬件的优化方式；</p><p>真的是“团队作战”的方式来优化“团战”了；</p><p><img src="https://pic1.zhimg.com/v2-b5cfbe8f8d96c1ded913c144721a0962_720w.png?rss" data-caption="" data-size="normal" data-rawwidth="626" data-rawheight="474" data-watermark="watermark" data-original-src="v2-b5cfbe8f8d96c1ded913c144721a0962" data-watermark-src="v2-64581b25c0a5dc2e1bcff5e0ca5da75f" data-private-watermark-src="v2-2dfc788c8931eb8eba80bdf94c819175" style="max-width: 400px;"></p><p>这个专项群最后涨到一个75人的规模。</p><p>往往在大型团队里推进一个事情，都是很困难的，尤其在临近上线大家高压的情况下。</p><p>实际在天刀手游这里做的时候，固然信息在大型团队里传播还是不容易的，但是你能清晰的感受到大家那种想把事情做牛逼的劲头 ；</p><p>你在解释清楚要做什么的时候，大家都非常积极，常常会一起讨论怎么把这个事情做得更好，拿出更好的方案，迅速推进；</p><p>很有意思的是特效美术，他们已经是端游时期过来的老司机了，各种LOD做得都比较到位，但是我们还需要根据玩家的关注点进一步裁切；</p><p>你明显能看到美术舍不得自己精心制作的效果要进一步裁切的那种扭曲的表情。</p><p>但是在策划细心解释，拉着美术一起看团战的视频，看统战的评价之后，就还是龇牙咧嘴的把大量的技能特效一个个撸过来,很多地方比我们预想的裁剪更到位一些；</p><p>什么叫最帅美术？就是这种为了性能，能把自己美美的作品，细腻的一个个点，打上low lod tag的特效哥们了；</p><p>这样的火花就像过年时候的鞭炮一样，此起彼伏的在项目中爆开。</p><p>这种大家齐心协力把一件事情做好的劲头，是非常鼓舞人心的，虽然每天工作量都很大，但我每天早上醒来就很盼望着上班，迫不及待的到公司开始梳理策略，看数据和写代码。</p><p>如果说端游时期的多人优化，还是几个程序员，湖边钓鱼般的安安静静写代码来做提升，手游优化就是如同火爆的总决赛了；</p><p><img src="https://pic1.zhimg.com/v2-57ca347808786a85110ff116346db7d1_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1087" data-rawheight="489" data-watermark="watermark" data-original-src="v2-57ca347808786a85110ff116346db7d1" data-watermark-src="v2-af036287baf443705a13cd3fdc1bf95f" data-private-watermark-src="v2-51eac020fcf31ba5a52691b440e51161" style="max-width: 400px;"></p><p>一顿操作下来，大家把团战从20多帧，优化到40帧，not bad!</p><p>有时候觉得天刀就像《doom启世录》里的创造奇迹的湖畔小屋，只是这里不只是程序员安静的输出，团队的集体输出更NB；</p><hr><p><i>“Much heroic programming ensued. Several hundred thousand lines of code were written. And rewritten. And rewritten. And rewritten”</i></p><p>（卡马克为abrash的《graphics programming black book》写的序）</p><p>在天刀，我们很多事情，都会迭代很多次，只要下一遍会更好，我们还会做，中间我们也会得到支持和信任；</p><p><img src="https://pic1.zhimg.com/v2-1c488f9b8c95abab88e3595ba57defbc_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1233" data-rawheight="654" data-watermark="watermark" data-original-src="v2-1c488f9b8c95abab88e3595ba57defbc" data-watermark-src="v2-20a7bea381f9830807c5058ec0acd129" data-private-watermark-src="v2-34793d91ce7b73e084192a01783469f9" style="max-width: 400px;"></p><p>（天刀端游全场景覆盖的树）</p><p>这个全场景覆盖的树，我们在端游中已经实现过两次，但是均以失败告终，第二次的时候，制作人也明确表示觉得这个方向不行，希望程序团队把注意力放到别的地方去。</p><p>正常情况下，老板这样的表态，继续做的话，即便结果很好，最后恐怕很难受到认可；</p><p>但是主刀的程序，偏偏就是偷偷地继续硬啃，继续了第三遍的尝试，最后当我们拿出这样的结果的时候，制作人说：good job，大家的坚持是对的。</p><p><img src="https://pic1.zhimg.com/v2-68df70a0cd29274befcf7dd6289f3416_720w.jpg?rss" data-caption="" data-size="normal" data-rawwidth="1241" data-rawheight="697" data-watermark="watermark" data-original-src="v2-68df70a0cd29274befcf7dd6289f3416" data-watermark-src="v2-f987a29376cc9bc91cdade4a9188fd88" data-private-watermark-src="v2-4cba641e82e427afb4f8d60a62da86c2" style="max-width: 400px;"></p><p>（天刀手游的植被）</p><p>必须要说，手游上的植被要比端游上艰难得多，手游的gpu设计真是对植被太不友好了，为了达到好的效果，我们一直追各种技术，gdc一开，horizon的植被做的好，有相关的技术我们升级一波；</p><p>有时候我们回溯老的论文，发现一个顶点压缩技术可以用，升级一波；</p><p>而每一波，两个植被小哥，都要将所有的植被过一遍，有的要各种调整贴图模型，有的要重新设置风力，有的要重新导出，而所有的调整都要做充分的测试；</p><p>这种“全过一遍”的技术升级，前前后后我们做了超过6遍，每次我们都得到“只要效果好，我们就做”这样的支持；</p><p>“重做“和“再试一次“本身并不难，难的是在大型团队里，有好的空间，好的支持；</p><p>在温度性能有很大压力的时候，程序团队表示再尝试优化一波，不要降低美术规格，ok；</p><p>在做新地形系统的时候，很长时间各种bug飞，团队开始问是不是这个技术不合适，程序表示我们认为可以处理好，ok；</p><p>。。。</p><hr><p>当然团队也还是有很多的问题要解决，开发中的很多不足需要我们改进，但在我眼里的大家，就是一群为了做出好东西，愿意反复折腾自己的开发者；</p><p>天刀手游，凝聚了我们十年狂热，希望大家喜欢；</p>