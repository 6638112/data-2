➜Z-Blog关闭隐藏评论功能的修改
https://www.williamlong.info/archives/6170.html	19602
<p>　　在Z-Blog系统中，有时会需要一个功能，就是针对超过180天以前的文章自动关闭并隐藏评论，由于Z-Blog本身没有这个插件，因此这里介绍一下如何在程序代码上进行修改。</p>
<p>　　这个功能主要是为了防止恶意攻击性评论设置的，我们知道，有很多恶意举报用户，这些人整天吃饱了饭没事干，会花很大精力翻网站几年前的留言去找问题，然后进行恶意举报，如果找不到的话，还会通过代理服务器主动发布恶意评论来栽赃陷害，接着进行恶意举报，因此对于很多网站来说是需要这样的功能，就是关闭和隐藏旧文章的评论，同时对于新发布的评论进行先审后发的功能。</p>
<p>　　要想让这个功能在Z-Blog中实现，修改方法如下：</p>
<p>　　在 c_system_lib.asp 中找到Function Export_CMTandTB(intPage)函数，在函数开头增加一行：</p>
<p>　　If DateDiff(&quot;d&quot;,PostTime,now())&gt;180 Then Exit Function</p>
<p>　　这样就能实现180天之前的文章停止并隐藏评论，修改完成之后需要进行一次文件重建的操作。</p>
<p>　　对于评论进行先审后发的功能，实际不用修改代码，安装使用TotoroⅢ 3.2插件，然后设置&ldquo;设置系统审核阙值&rdquo;为0，这样所有评论必须审核后才能发布。</p>